{"version":3,"file":"js/299.224d8ef7.js","mappings":"okGAsKE,MAAMA,GAAeC,EAAAA,EAAAA,IAAO,iBACtB,cAAEC,GAAkBF,EAEpBG,IAAgBF,EAAAA,EAAAA,IAAO,kBAEvB,SACJG,GAAQ,mBACRC,IACEF,GAEEG,IAAWC,EAAAA,EAAAA,IAAI,MACfC,IAAiBD,EAAAA,EAAAA,IAAI,MAE3B,IAAIE,GACAC,GAEJ,MAAMC,IAAmBJ,EAAAA,EAAAA,IAAI,IAEvBK,IAAOL,EAAAA,EAAAA,IAAI,CACfM,WAAY,GACZC,UAAW,CACTC,KAAM,KACNC,SAAU,KACVC,KAAM,KACNC,SAAU,KACVC,YAAa,KACbC,cAAc,EACdC,MAAO,UACPC,eAAgB,EAChBC,QAAQ,EACRC,OAAQ,KACRC,SAAU,MAEZC,aAAc,GACdC,SAAU,GACVC,eAAe,IAGXC,IAAW5B,EAAAA,EAAAA,IAAO,aAElB,cACJ6B,GAAa,YACbC,GAAW,aACXC,GAAY,0BACZC,GAAyB,uBACzBC,IACEL,IAEE,uBACJM,GAAsB,oBACtBC,KACIC,EAAAA,EAAAA,IAAOP,IAEPQ,GAAkBC,IACtB3B,GAAK4B,MAAM3B,WAAa4B,OAAOC,OAAO,CAAC,EAAGH,GAC1C7B,GAAWiC,MAAM,EAIbC,GAAUC,UAEd,IAAIC,EAcJ,GAXEA,EADElC,GAAK4B,MAAMZ,oBACCG,GAAY,IACrBnB,GAAK4B,MAAM1B,UACdH,iBAAkBA,GAAiB6B,cAGvBR,GAAa,IACtBpB,GAAK4B,MAAM1B,UACdH,iBAAkBA,GAAiB6B,QAInCM,EAAMC,YAAc,IAEtB,OADA7C,EAAc4C,EAAME,SACb,KAGT9C,EAAc4C,EAAME,SACpBd,KACAzB,GAAMwC,MAAM,EAIRC,GAAYL,MAAOM,EAAQZ,KAG/B,GAFA3B,GAAK4B,MAAMZ,cAAgBuB,EAEvBvC,GAAK4B,MAAMZ,cACbwB,SACK,OAECnB,GAA0BM,EAAKc,IAErCC,QAAQC,IAAIpB,GAAuBK,OAEnC,MAAM,GACJa,EAAE,KACFtC,EAAI,SACJC,EAAQ,KACRC,EAAI,SACJC,EAAQ,gBACRsC,EAAe,YACfrC,EAAW,aACXC,EAAY,MACZC,EAAK,eACLC,EAAc,OACdC,GACEY,GAAuBK,MAAMiB,SAEjC7C,GAAK4B,MAAM1B,UAAY,CACrB4C,WAAYL,EACZtC,OACAC,WACAC,OACAC,WACAsC,kBACArC,cACAC,eACAC,QACAC,iBACAC,SACAE,SAAUU,GAAuBK,MAAMf,SACvCD,OAAQW,GAAuBK,MAAMhB,QAGvCb,GAAiB6B,MAAQL,GAAuBK,MAAM7B,gBAExD,CAEAF,GAAMkC,MAAM,EA4Bd,SAASS,KACPxC,GAAK4B,MAAM1B,UAAY,CACrBC,KAAM,KACNC,SAAU,KACVC,KAAM,KACNC,SAAU,KACVC,YAAa,KACbC,cAAc,EACdC,MAAO,UACPC,eAAgB,EAChBC,QAAQ,EACRC,OAAQ,KACRC,SAAU,MAEZb,GAAK4B,MAAMd,aAAe,GAC1Bf,GAAiB6B,MAAQ,EAC3B,CAGAK,eAAec,KACb,MAAMC,EAAO,+BAEPC,EAAQxD,KAERyD,EAAU,CACdC,QAAS,CACP,eAAgB,mBAChB,cAAmB,UAASF,KAE9BG,OAAQ,OAGJC,QAAiB7D,GAASwD,EAAKE,GAErClD,GAAK4B,MAAMb,SAAWsC,EAASrD,IACjC,CAGA,SAASsD,KACPP,KACAzB,IACF,C,OAEAgC,MAEAC,EAAAA,EAAAA,KAAU,KACR1D,GAAQ,IAAI2D,EAAAA,GAAM9D,GAASkC,OAC3B9B,GAAa,IAAI0D,EAAAA,GAAM5D,GAAegC,MAAM,I,ozHCjXhD,MAAM6B,GAAc,GAEpB,S","sources":["webpack://amis/./src/views/employeeManagement.vue","webpack://amis/./src/views/employeeManagement.vue?2812"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <h3 class=\"mb-5\">員工管理</h3>\n\n    <h4 class=\"mb-2\">員工清單</h4>\n    <div class=\"d-flex justify-content-end mb-2\">\n      <button type=\"button\" class=\"btn btn-primary\" @click=\"openModal(true)\">新增公司員工</button>\n    </div>\n    <table class=\"table\">\n      <thead>\n        <tr>\n          <th scope=\"col\">姓名</th>\n          <th scope=\"col\">小名</th>\n          <!-- <th scope=\"col\">部門</th> -->\n          <th scope=\"col\">職稱</th>\n          <th scope=\"col\">電話</th>\n          <th scope=\"col\">到職日期</th>\n          <th class=\"text-center\" scope=\"col\">編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in employeeSettingData\" :key=\"item.id\">\n          <td class=\"align-middle\">{{ item.name }}</td>\n          <td class=\"align-middle\">{{ item.nickname }}</td>\n          <!-- <td class=\"align-middle\">{{ item.departmentId }}</td> -->\n          <td class=\"align-middle\">{{ item.roleName }}</td>\n          <td class=\"align-middle\">{{ item.phoneNumber }}</td>\n          <td class=\"align-middle\">{{ item.hireDate }}</td>\n          <td class=\"text-center\">\n            <div class=\"btn-group\" role=\"group\" aria-label=\"Basic example\">\n              <button type=\"button\" class=\"btn btn-danger\" @click=\"openDeleteModa(item);\">刪除</button>\n              <button type=\"button\" class=\"btn btn-primary\" @click=\"openModal(false, item)\">編輯</button>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n\n  <!-- 新增 / 修改員工 modal -->\n  <div class=\"modal fade\" ref=\"modalRef\">\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">{{ data.isAddEmployee ? '新增':'編輯' }}公司員工</h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body px-1\">\n          <form>\n            <div class=\"row mb-3\">\n              <label for=\"name\" class=\"col-sm-2 col-form-label\">姓名</label>\n              <div class=\"col-sm-10\">\n                <input type=\"text\" class=\"form-control\" id=\"name\"\n                      v-model=\"data.modalData.name\">\n              </div>\n            </div>\n            <div class=\"row mb-3\">\n              <label for=\"userId\" class=\"col-sm-2 col-form-label\">帳號</label>\n              <div class=\"col-sm-10\">\n                <input type=\"text\" class=\"form-control\" id=\"userId\"\n                      v-model=\"data.modalData.userId\">\n              </div>\n            </div>\n            <div class=\"row mb-3\">\n              <label for=\"password\" class=\"col-sm-2 col-form-label\">密碼</label>\n              <div class=\"col-sm-10\">\n                <input type=\"text\" class=\"form-control\" id=\"password\"\n                      v-model=\"data.modalData.password\">\n              </div>\n            </div>\n            <div class=\"row mb-3\">\n              <label for=\"nickname\" class=\"col-sm-2 col-form-label\">小名</label>\n              <div class=\"col-sm-10\">\n                <input type=\"text\" class=\"form-control\" id=\"nickname\"\n                      v-model=\"data.modalData.nickname\">\n              </div>\n            </div>\n            <div class=\"row mb-3\">\n              <label for=\"departmentId\" class=\"col-sm-2 col-form-label\">部門</label>\n              <div class=\"col-sm-10\">\n                <div class=\"d-flex align-items-center h-100\">\n                  <div class=\"form-check form-check-inline\">\n                    <input class=\"form-check-input\" type=\"checkbox\" id=\"AestheticMedicine\"\n                          value=\"AestheticMedicine\"\n                          v-model=\"departmentIdList\">\n\n                    <label class=\"form-check-label\" for=\"AestheticMedicine\">醫美部</label>\n                  </div>\n\n                  <div class=\"form-check form-check-inline\">\n                    <input class=\"form-check-input\" type=\"checkbox\" id=\"Beauty\"\n                          value=\"Beauty\"\n                          v-model=\"departmentIdList\">\n\n                    <label class=\"form-check-label\" for=\"Beauty\">美容部</label>\n                  </div>\n\n                </div>\n              </div>\n            </div>\n            <div class=\"row mb-3\">\n              <label for=\"jobTitle\" class=\"col-sm-2 col-form-label\">職稱</label>\n              <div class=\"col-sm-10\">\n                <select class=\"form-select\" id=\"jobTitle\"\n                        v-model=\"data.modalData.role\">\n                  <option v-for=\"item in data.roleData\" :key=\"item.id\" :value=\"item.id\">{{ item.name }}</option>\n                </select>\n              </div>\n            </div>\n            <div class=\"row mb-3\">\n              <label for=\"phoneNumber\" class=\"col-sm-2 col-form-label\">電話</label>\n              <div class=\"col-sm-10\">\n                <input type=\"text\" class=\"form-control\" id=\"phoneNumber\"\n                      v-model=\"data.modalData.phoneNumber\">\n              </div>\n            </div>\n            \n            <div class=\"row mb-3\">\n              <label for=\"hireDate\" class=\"col-sm-2 col-form-label\">到職日期</label>\n              <div class=\"col-sm-10\">\n                <input type=\"date\" class=\"form-control\" id=\"hireDate\"\n                      v-model=\"data.modalData.hireDate\">\n              </div>\n            </div>\n\n            <div class=\"row align-items-center mb-3\">\n              <label for=\"color\" class=\"col-sm-2 col-form-label\">顏色</label>\n              <div class=\"col-sm-10\">\n                <input type=\"color\" class=\"form-control\" id=\"color\"\n                      v-model=\"data.modalData.color\">\n              </div>\n            </div>\n          </form>\n        </div>\n        <div class=\"modal-footer px-1\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\n          <button type=\"button\" class=\"btn btn-primary\" @click=\"sendOut()\">確定</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- 刪除 modal -->\n  <div class=\"modal fade\" ref=\"deleteModalRef\">\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">刪除員工資料</h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n          確認要刪除員工 <span class=\"text-danger\">{{ data.deleteitem.name }}</span>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\n          <button type=\"button\" class=\"btn btn-danger\" @click=\"deleteEmployee(data.deleteitem.id)\">確定</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\n  import { ref, onMounted, inject, toRefs } from 'vue';\n  import { Modal } from 'bootstrap';\n\n  const alertMessage = inject('alertMessage');\n  const { updateMessage } = alertMessage;\n\n  const fetchFunction = inject('fetchFunction');\n\n  const {\n    fetchApi,\n    getTokenFromCookie\n  } = fetchFunction;\n\n  const modalRef = ref(null);\n  const deleteModalRef = ref(null);\n\n  let modal;\n  let deleteModa;\n\n  const departmentIdList = ref([]);\n\n  const data = ref({\n    deleteitem: '',\n    modalData: {\n      name: null,\n      nickname: null,\n      role: null,\n      hireDate: null,\n      phoneNumber: null,\n      nurseLicense: true,\n      color: '#000000',\n      doctorSequence: 0,\n      active: true,\n      userId: null,\n      password: null\n    },\n    departmentId: '',\n    roleData: [],\n    isAddEmployee: true,\n  })\n\n  const Employee = inject('Employee');\n\n  const {\n    employeeState,\n    addEmployee,\n    editEmployee,\n    getInitUpdateEmployeeData,\n    getEmployeeSettingData,\n  } = Employee;\n\n  const {\n    initUpdateEmployeeData,\n    employeeSettingData\n    } = toRefs(employeeState);\n\n  const openDeleteModa = (item) => {\n    data.value.deleteitem = Object.assign({}, item);\n    deleteModa.show();\n  }\n\n  /** 確認 */\n  const sendOut = async() => {\n\n    let judge;\n\n    if (data.value.isAddEmployee) {\n      judge = await addEmployee({\n        ...data.value.modalData,\n        departmentIdList: departmentIdList.value,\n      });\n    } else {\n      judge = await editEmployee({\n        ...data.value.modalData,\n        departmentIdList: departmentIdList.value,\n      });\n    }\n\n    if (judge.statusCode >= 400) {\n      updateMessage(judge.message);\n      return null;\n    }\n\n    updateMessage(judge.message);\n    getEmployeeSettingData();\n    modal.hide();\n  }\n\n  /** 開啟 Modal */\n  const openModal = async (status, item) => {\n    data.value.isAddEmployee = status;\n    \n    if (data.value.isAddEmployee) {\n      resetModalData();\n    } else {\n      // 編輯，帶原先值\n      await getInitUpdateEmployeeData(item.id);\n\n      console.log(initUpdateEmployeeData.value);\n\n      const {\n        id,\n        name,\n        nickname,\n        role,\n        hireDate,\n        resignationDate,\n        phoneNumber,\n        nurseLicense,\n        color,\n        doctorSequence,\n        active,\n      } = initUpdateEmployeeData.value.employee;\n      \n      data.value.modalData = {\n        employeeId: id,\n        name,\n        nickname,\n        role,\n        hireDate,\n        resignationDate,\n        phoneNumber,\n        nurseLicense,\n        color,\n        doctorSequence,\n        active,\n        password: initUpdateEmployeeData.value.password,\n        userId: initUpdateEmployeeData.value.userId,\n      };\n      \n      departmentIdList.value = initUpdateEmployeeData.value.departmentIdList;\n      // data.value.departmentId = departmentId;\n    }\n\n    modal.show();\n  }\n\n  /** 刪除員工 */\n  // const deleteEmployee = async(id) => {\n  //   const url = `/api/Employee?id=${id}`;\n\n  //   const token = getTokenFromCookie();\n\n  //   const options = {\n  //     headers: {\n  //       'Content-Type': 'application/json',\n  //       \"Authorization\" : `Bearer ${token}`\n  //     },\n  //     method: 'DELETE',\n  //   };\n\n  //   const response = await fetchApi(url, options);\n\n  //   updateMessage(response.message);\n\n  //   if (response.statusCode >= 400) return null;\n\n  //   getEmployeeSettingData();\n  //   deleteModa.hide();\n  // }\n\n  /** 清空 Modal 資料 */\n  function resetModalData() {\n    data.value.modalData = {\n      name: null,\n      nickname: null,\n      role: null,\n      hireDate: null,\n      phoneNumber: null,\n      nurseLicense: true,\n      color: '#000000',\n      doctorSequence: 0,\n      active: true,\n      userId: null,\n      password: null\n    }\n    data.value.departmentId = '';\n    departmentIdList.value = [];\n  }\n\n  /** 取得職稱 */\n  async function getRole() {\n    const url = `/api/Role/GetAllEmployeeRole`;\n\n    const token = getTokenFromCookie();\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${token}`\n      },\n      method: 'GET'\n    }\n\n    const response = await fetchApi(url, options);\n\n    data.value.roleData = response.data;\n  }\n\n  /** 初始 */\n  function init() {\n    getRole();\n    getEmployeeSettingData();\n  }\n\n  init();\n\n  onMounted(() => {\n    modal = new Modal(modalRef.value);\n    deleteModa = new Modal(deleteModalRef.value);\n  });\n</script>","import script from \"./employeeManagement.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./employeeManagement.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["alertMessage","inject","updateMessage","fetchFunction","fetchApi","getTokenFromCookie","modalRef","ref","deleteModalRef","modal","deleteModa","departmentIdList","data","deleteitem","modalData","name","nickname","role","hireDate","phoneNumber","nurseLicense","color","doctorSequence","active","userId","password","departmentId","roleData","isAddEmployee","Employee","employeeState","addEmployee","editEmployee","getInitUpdateEmployeeData","getEmployeeSettingData","initUpdateEmployeeData","employeeSettingData","toRefs","openDeleteModa","item","value","Object","assign","show","sendOut","async","judge","statusCode","message","hide","openModal","status","resetModalData","id","console","log","resignationDate","employee","employeeId","getRole","url","token","options","headers","method","response","init","onMounted","Modal","__exports__"],"sourceRoot":""}