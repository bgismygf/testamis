{"version":3,"file":"js/815.d540776b.js","mappings":"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","sources":["webpack://amis/./src/views/bodyPartSetting.vue","webpack://amis/./src/views/bodyPartSetting.vue?560f"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <h3 class=\"mb-5\">療程部位管理</h3>\n\n    <h4 class=\"mb-2\">維護療程部位</h4>\n    <div class=\"d-flex justify-content-between mb-2\">\n      <div class=\"row g-3\">\n        <div class=\"col-auto\">\n          <label for=\"inputSearch\" class=\"col-form-label\">療程部位</label>\n        </div>\n        <div class=\"col-auto\">\n          <input type=\"text\" id=\"inputSearch\" class=\"form-control\" v-model=\"subCourseSearchInput\">\n        </div>\n        <div class=\"col-auto\">\n          <button type=\"button\" class=\"btn btn-primary\" @click=\"inputSearch()\">搜尋</button>\n          <button type=\"button\" class=\"btn btn-primary ms-2\" @click=\"getBodyPartAll(); subCourseSearchInput = null;\">重置</button>\n        </div>\n      </div>\n      <button type=\"button\" class=\"btn btn-primary\" @click=\"openModal(true)\">新增療程部位</button>\n    </div>\n    <table class=\"table\">\n      <thead>\n        <tr>\n          <th scope=\"col\">療程部位</th>\n          <th class=\"text-center\" scope=\"col\">編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"bodyPartItem in bodyPart\" :key=\"bodyPartItem\">\n          <td class=\"align-middle\">{{ bodyPartItem.name }}</td>\n          <td class=\"text-center\">\n            <div class=\"btn-group\" role=\"group\" aria-label=\"Basic example\">\n              <!-- <button type=\"button\" class=\"btn btn-danger\" @click=\"openDeleteModal(settingDataItem)\">刪除</button> -->\n              <button type=\"button\" class=\"btn btn-primary\" @click=\"openModal(false, bodyPartItem)\">編輯</button>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n\n  <!-- 新增 / 修改療程部位 modal -->\n  <div class=\"modal fade\" ref=\"modalRef\">\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">{{ data.isAddEmployee ? '新增':'編輯' }}療程部位</h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body px-1\">\n          <form>\n            <div class=\"row mb-3\">\n              <label for=\"name\" class=\"col-sm-3 col-form-label\">療程部位 :</label>\n              <div class=\"col-sm-9\">\n                <input type=\"text\" class=\"form-control\" id=\"name\"\n                      v-model=\"modalData.name\">\n              </div>\n            </div>\n          </form>\n        </div>\n        <div class=\"modal-footer px-1\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\n          <button type=\"button\" class=\"btn btn-primary\" @click=\"sendOut()\">確定</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- 刪除 modal -->\n  <!-- <div class=\"modal fade\" ref=\"deleteModalRef\">\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">刪除員工資料</h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n          確認要刪除員工 <span class=\"text-danger\">{{ data.deleteitem.name }}</span>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\n          <button type=\"button\" class=\"btn btn-danger\" @click=\"deleteEmployee(data.deleteitem.id)\">確定</button>\n        </div>\n      </div>\n    </div>\n  </div> -->\n</template>\n\n<script setup>\n  import { ref, onMounted, inject } from 'vue';\n  import { Modal } from 'bootstrap';\n\n  const alertMessage = inject('alertMessage');\n    const { updateMessage } = alertMessage;\n\n    const fetchFunction = inject('fetchFunction');\n\n    const {\n      fetchApi,\n      getTokenFromCookie\n    } = fetchFunction;\n\n    const modalRef = ref(null);\n    // const deleteModalRef = ref(null);\n    // let deleteModa;\n\n    let modal;\n\n    const data = ref({\n      employeeData: [],\n      deleteitem: '',\n      departmentId: '',\n      roleData: [],\n      isAddEmployee: true,\n    })\n\n    /** 確認 */\n    const sendOut = async() => {\n\n      let judge;\n\n      if (data.value.isAddEmployee) {\n        judge = await addBodyPart();\n      } else {\n        judge = await editBodyPart();\n      }\n\n      if (judge.statusCode >= 400) {\n        updateMessage(judge.message);\n        return null;\n      }\n\n      updateMessage(judge.message);\n      getBodyPartAll();\n      modal.hide();\n    }\n\n    const modalData = ref({});\n    const subcourseForm = ref([]);\n\n    /** 開啟 Modal */\n    const openModal = async (status, item) => {\n      data.value.isAddEmployee = status;\n\n      const subcoursePointsArr = [];\n\n      bodyPart.value.forEach(item => {\n        subcoursePointsArr.push({\n          id: item.id,\n          point: null,\n          name: item.name\n        });\n      });\n\n      subcourseForm.value = subcoursePointsArr;\n      \n      if (data.value.isAddEmployee) {\n        resetModalData();\n      } else {\n        // 編輯，帶原先值\n        const getData = await getBodyPartById(item.id);\n\n        const {\n          id,\n          name,\n          sequence,\n          active\n        } = getData;\n\n        modalData.value = {\n          id,\n          name,\n          sequence,\n          active\n        };\n      }\n\n      modal.show();\n    }\n\n    /** 更新身體部位  */\n    const editBodyPart = async() => {\n\n      const PATCHData = {\n        ...modalData.value,\n      }\n\n      const url = `/api/BodyPart`;\n\n      const token = getTokenFromCookie();\n\n      const options = {\n        headers: {\n          'Content-Type': 'application/json',\n          \"Authorization\" : `Bearer ${token}`\n        },\n        method: 'PATCH',\n        body: JSON.stringify(PATCHData),\n      };\n\n      return await fetchApi(url, options);\n    }\n\n    /** 新增身體部位 */\n    const addBodyPart = async() => {\n\n      const postData = {\n        name: modalData.value.name,\n        active: true\n      }\n\n      const url = `/api/BodyPart`;\n\n      const token = getTokenFromCookie();\n\n      const options = {\n        headers: {\n          'Content-Type': 'application/json',\n          \"Authorization\" : `Bearer ${token}`\n        },\n        method: 'POST',\n        body: JSON.stringify(postData),\n      };\n\n      return await fetchApi(url, options);\n    }\n\n    /** 清空 Modal 資料 */\n    function resetModalData() {\n      modalData.value = {\n        id: null,\n        name: null,\n        sequence: 0,\n        active: true\n      }\n    }\n\n    // API\n\n    /** 根據代號取得身體部位 */\n    async function getBodyPartById(id) {\n      const url = `/api/BodyPart/GetById?id=${id}`;\n\n      const token = getTokenFromCookie();\n\n      const options = {\n        headers: {\n          'Content-Type': 'application/json',\n          \"Authorization\" : `Bearer ${token}`\n        },\n        method: 'GET'\n      }\n\n      const response = await fetchApi(url, options);\n\n      return response.data;\n    }\n\n    const bodyPart = ref([]);\n\n    /** 取得所有身體部位 */\n    async function getBodyPartAll() {\n\n      const url = `/api/BodyPart/GetAll`;\n\n      const token = getTokenFromCookie();\n\n      const options = {\n        headers: {\n          'Content-Type': 'application/json',\n          \"Authorization\" : `Bearer ${token}`\n        },\n        method: 'GET'\n      }\n\n      const response = await fetchApi(url, options);\n      \n      bodyPart.value = response.data;\n    }\n\n    const subCourseSearchInput = ref(null);\n    \n    /** 搜尋 - 根據名稱模糊搜尋身體部位 */\n    async function inputSearch() {\n      const url = `/api/BodyPart/GetByName?name=${subCourseSearchInput.value}`;\n\n      const token = getTokenFromCookie();\n\n      const options = {\n        headers: {\n          'Content-Type': 'application/json',\n          \"Authorization\" : `Bearer ${token}`\n        },\n        method: 'GET'\n      }\n\n      const response = await fetchApi(url, options);\n\n      bodyPart.value = response.data;\n    }\n\n    /** 初始 */\n    async function init() {\n      await getBodyPartAll();\n    }\n\n    init();\n\n    onMounted(() => {\n      modal = new Modal(modalRef.value);\n    });\n</script>","import script from \"./bodyPartSetting.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./bodyPartSetting.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["alertMessage","inject","updateMessage","fetchFunction","fetchApi","getTokenFromCookie","modalRef","ref","modal","data","employeeData","deleteitem","departmentId","roleData","isAddEmployee","sendOut","async","judge","value","addBodyPart","editBodyPart","statusCode","message","getBodyPartAll","hide","modalData","subcourseForm","openModal","status","item","subcoursePointsArr","bodyPart","forEach","push","id","point","name","resetModalData","getData","getBodyPartById","sequence","active","show","PATCHData","url","token","options","headers","method","body","JSON","stringify","postData","response","subCourseSearchInput","inputSearch","init","onMounted","Modal","__exports__"],"sourceRoot":""}