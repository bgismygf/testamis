{"version":3,"file":"js/57.751b3953.js","mappings":"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","sources":["webpack://amis/./src/views/careRecord/careRecordIndex.vue","webpack://amis/./src/views/careRecord/careRecordIndex.vue?2961"],"sourcesContent":["<template>\n  <div class=\"container\" style=\"margin-top: 49px;\">\n    <p class=\"mb-0 text-end text-gray3 mb-3 me-3\">{{ caredTextJudge ? '關心完成' : '尚未關心' }} : 共 {{ careDataLength() }}筆</p>\n\n    <div class=\"row\">\n      <div class=\"col-lg-2\">\n        <!-- 登入醫美師 -->\n        <div class=\"py-4 px-3 bg-white rounded-20 border border-gray2 mb-3\">\n          <h6 class=\"text-main-dark2 mb-3 text-center\" v-if=\"loggedInBeautician\">登入醫美師 : {{ loggedInBeautician.employeeName }}</h6>\n\n          <select class=\"form-select rounded-pill\" v-model=\"searchCareData.beauticianId\">\n            <option selected hidden :value=\"null\">專屬醫美師</option>\n            <option v-for=\"beautician in beauticiansAAForCareData\"\n                    :key=\"beautician.id\"\n                    :value=\"beautician.id\">\n              {{ beautician.name }}        \n            </option>\n          </select>\n        </div>\n\n        <!-- 過濾查詢、治療日期、客戶搜尋 -->\n        <div class=\"py-4 px-3 bg-white rounded-20 border border-gray2\">\n          <div class=\"mb-6\">\n            <h6 class=\"text-main-dark2 mb-3 text-center\">過濾查詢</h6>\n\n            <select class=\"form-select rounded-pill mb-2\"\n                    v-model=\"searchCareData.courseType\">\n              <option selected hidden :value=\"null\">療程篩選</option>\n              <option v-for=\"item in courseTypeData\"\n                      :key=\"item.id\"\n                      :value=\"item.id\">\n                      {{ item.name }}\n              </option>\n            </select>\n\n            <select class=\"form-select rounded-pill mb-2\"\n                    v-model=\"searchCareData.operatorId\">\n              <option selected hidden :value=\"null\">選擇醫師</option>\n              <option v-for=\"item in allDoctorData\"\n                      :key=\"item.id\"\n                      :value=\"item.id\">\n                      {{ item.name }}\n              </option>\n            </select>\n\n            <select class=\"form-select rounded-pill\"\n                    v-model=\"searchCareData.cared\">\n              <option selected hidden :value=\"null\">關心狀態</option>\n              <option :value=\"true\">已關心</option>\n              <option :value=\"false\">未關心</option>\n            </select>\n          </div>\n\n          <div class=\"mb-6\">\n            <h6 class=\"text-main-dark2 mb-3 text-center\">治療日期</h6>\n\n            <input type=\"date\" class=\"form-control rounded-pill text-main-dark2 mb-2\"\n              placeholder=\"開始日期\"\n              v-model=\"searchCareData.startDate\">\n\n            <input type=\"date\" class=\"form-control rounded-pill text-main-dark2\"\n              placeholder=\"截止日期\"\n              v-model=\"searchCareData.endDate\">\n          </div>\n\n          <div class=\"mb-6\">\n            <h6 class=\"text-main-dark2 mb-3 text-center\">客戶搜尋</h6>\n\n            <div class=\"position-relative mt-4 mb-2\">\n              <label for=\"customerName\" style=\"left: 14px;\" class=\"position-absolute top-50 translate-middle-y form-label text-main-dark2\">姓 名</label>\n              <input type=\"text\" class=\"form-control rounded-pill text-main-dark2\"\n                      style=\"text-indent: 50px;\"\n                      id=\"customerName\"\n                      aria-describedby=\"customerName\"\n                      autocomplete=\"off\"\n                      v-model=\"searchCareData.customerName\">\n            </div>\n\n\n            <div class=\"position-relative mb-2\">\n              <label for=\"customerBirth\" style=\"left: 14px;\" class=\"position-absolute top-50 translate-middle-y form-label text-main-dark2\">生 日</label>\n              <input type=\"text\" class=\"form-control rounded-pill text-main-dark2\"\n                      style=\"text-indent: 50px;\"\n                      id=\"customerBirth\"\n                      aria-describedby=\"customerBirth\"\n                      autocomplete=\"off\"\n                      placeholder=\"YYYMMDD\"\n                      v-model=\"searchCareData.customerBirthday\"\n                      maxlength=\"8\">\n            </div>\n            \n            <div class=\"position-relative\">\n              <label for=\"customerTel\" style=\"left: 14px;\" class=\"position-absolute top-50 translate-middle-y form-label text-main-dark2\">電 話</label>\n              <input type=\"tel\" class=\"form-control rounded-pill text-main-dark2\"\n                      style=\"text-indent: 50px;\"\n                      id=\"customerTel\"\n                      aria-describedby=\"customerTel\"\n                      autocomplete=\"off\"\n                      placeholder=\"09xx-xxx-xxx\"\n                      v-model=\"searchCareData.customerCellPhone\"\n                      maxlength=\"10\">\n            </div>\n          </div>\n\n\n          <div class=\"row gx-3 mt-4\">\n            <div class=\"col-6 mb-2\">\n              <button type=\"button\" class=\"btn btn-outline-main-dark w-100 rounded-pill active\"\n                      @click=\"careRecordSearchCareData()\">\n                      查 詢\n              </button>\n            </div>\n            \n            <div class=\"col-6 mb-2\">\n              <button type=\"button\" class=\"btn btn-outline-second2 w-100 rounded-pill\"\n                      @click=\"resetCareRecordSearchCareData()\">\n                      重 置\n              </button>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <!-- 右邊 -->\n      <div class=\"col-lg-10\">\n        <div class=\"border border-main-dark1 rounded-20 p-4\">\n          \n          <div class=\"scroll-content-none\" style=\"height: 680px;\">\n            <div class=\"mb-3 toggle-active\">\n              <!-- 客戶資料 -->\n              <div class=\"bg-white border border-2 border-gray2 rounded-15 pt-3 mb-3\"\n                  v-for=\"(item, index) in careData\"\n                  :key=\"item.customer.id\">\n                <div class=\"d-flex align-items-center pb-3 px-4\">\n                  <!-- 客人頭 -->\n                  <img class=\"rounded-circle\" width=\"48\" height=\"48\" src=\"https://randomuser.me/api/portraits/men/75.jpg\" alt=\"\">\n                  <!-- 美容師小名 -->\n                  <div class=\"ms-7\">\n                    <div class=\"bg-main-dark2 rounded-circle position-relative nickName-icon\">\n                      <span class=\"text-white position-absolute top-50 start-50 translate-middle\">\n                        {{ item.customer.beauticianNickname }}\n                      </span>\n                    </div>\n                  </div>\n                  <!-- 客人名稱 -->\n                  <h6 class=\"mb-0 ms-2 fw-500 text-main-dark2\">{{ item.customer.name }}</h6>\n                  <!-- 生日 -->\n                  <p class=\"mb-0 fw-500 ms-3 me-auto text-main-dark2\">{{ item.customer.birthday }}</p>\n\n                  <div class=\"d-flex ms-auto\">\n\n                    <button type=\"button\" class=\"btn btn-outline-second2 rounded-pill ms-2\"\n                            @click=\"openHistoricalMedicalRecordsRefModal(item)\">\n                      歷史病歷\n                    </button>\n\n                    <button type=\"button\" class=\"btn btn-outline-second2 rounded-pill ms-2\"\n                            @click=\"openHistoricalMedicalRecordsRefModal(item)\">\n                      個人明細\n                    </button>\n\n                    <button type=\"button\" class=\"btn btn-outline-second2 rounded-pill ms-2\"\n                            @click=\"openContactRecordModel(item)\">\n                      聯絡紀錄\n                    </button>\n\n                    <router-link to=\"/appointment\" custom v-slot=\"{ navigate }\">\n                      <button type=\"button\" class=\"btn btn-outline-second2 rounded-pill ms-2\"\n                            @click=\"navigate\">\n                      約診\n                      </button>\n                    </router-link>\n\n                    <button type=\"button\" class=\"btn btn-outline-second2 rounded-pill ms-2\"\n                            @click=\"openSmsSampleModal(item.customer.id)\">\n                      傳訊\n                    </button>\n                  </div>\n\n                  <a href=\"#\" class=\"py-2 px-6 ms-2\"\n                    @click.prevent=\"accordionToggle(index, accordion.toggleCustomerData)\">\n                    <img class=\"toggle-customerData-icon toggle-icon-style\"\n                        src=\"@/assets/stylesheets/icon/arrow_down.png\"\n                        alt=\"arrow_down\" width=\"15\" height=\"7\">\n                  </a>\n                </div>\n\n                <!-- 資料 -->\n                <div class=\"toggle-customerData toggle-style\">\n\n                  <div class=\"border-top border-2 border-gray2 text-center\">\n                    <div class=\"d-flex text-main-dark2\">\n                      <p class=\"mb-0 fw-500 py-2 border-1 border-end border-gray2\" style=\"width: 14.8%;\">療程紀錄</p>\n                      <a class=\"mb-0 fw-500 py-2 border-1 border-end border-gray2 text-decoration-none\"\n                        @click.prevent=\"editCareRecord(item.customer.id)\"\n                        style=\"width: 28.1%;\" href=\"#\">\n                        <span>關心內容</span>\n                        <span v-if=\"item.careRecordWithMedicalRecordInfo.some(item => item.careRecordId)\">\n                          (修改)\n                        </span>\n                      </a>\n                      <a href=\"#\" class=\"text-decoration-none py-2 border-1 border-end border-gray2 text-center\" style=\"width: 19%;\"\n                          @click.prevent=\"openCustomerCommunicationModal(item)\">\n                        <span class=\"mb-0 fw-500 align-middle me-1\">客戶溝通</span>\n                        <img class=\"align-middle\" src=\"@/assets/stylesheets/icon/edit-02.png\" alt=\"icon\" width=\"12.62\" height=\"12.67\">\n                      </a>\n                      <p class=\"mb-0 fw-500 py-2 border-1 border-end border-gray2\" style=\"width: 19%;\">儲值及禮券剩餘</p>\n                      <p class=\"mb-0 fw-500 py-2 border-1 border-gray2\" style=\"width: 19.1%;\">下次約診狀況</p>\n                    </div>\n                  </div>\n                  <!-- 第一筆 -->\n                  <div class=\"d-flex\">\n                    <div class=\"d-flex flex-column\" style=\"width: 42.9%;\">\n                      <div class=\"d-flex h-100\"\n                          v-for=\"(careRecordWithMedicalRecordInfoItem, careRecordWithMedicalRecordInfoIndex) in item.careRecordWithMedicalRecordInfo\"\n                          :key=\"careRecordWithMedicalRecordInfoItem\">  \n                        <!-- 療程紀錄 -->\n                        <div class=\"p-3 border-1 border-end border-top border-gray2 text-main-dark2\" style=\"width: 34.5%;\">\n                          <div class=\"mb-2\">\n                            <p class=\"mb-0 text-gray3\">治療日期</p>\n                            <p class=\"mb-0\">{{ convertTimeFormatSlash(careRecordWithMedicalRecordInfoItem.appointmentDate) }}</p>\n                          </div>\n\n                          <div class=\"mb-2\">\n                            <p class=\"mb-0 text-gray3\">療程/ 醫師</p>\n                            <p class=\"mb-0\">{{ careRecordWithMedicalRecordInfoItem.courseName }} {{ careRecordWithMedicalRecordInfoItem.operatorName }}</p>\n                          </div>\n\n                          <div>\n                            <p class=\"mb-0 text-gray3\">本次使用量</p>\n                            <p class=\"mb-0\">{{ careRecordWithMedicalRecordInfoItem.usageAmount }} {{ careRecordWithMedicalRecordInfoItem.unitName }}</p>\n                          </div>\n                        </div>\n                        <!-- 關心內容 -->\n                        <!-- 修改 -->\n                        <div class=\"p-3 border-1 border-end border-top border-gray2 text-main-dark2\"\n                            style=\"width: 65.5%;\"\n                            v-if=\"!careRecordWithMedicalRecordInfoItem.careRecordId || item.customer.id === editSign\">\n                          <div class=\"row gx-3 mb-2\">\n                            <div class=\"col-7\">\n                              <select class=\"form-select rounded-pill\"\n                                      :disabled=\"disable.includes(careRecordWithMedicalRecordInfoIndex)\"\n                                      v-model=\"careRecordWithMedicalRecordInfoItem.careSituation\">\n                                <option selected hidden :value=\"null\">關心狀況</option>\n                                <option v-for=\"careSituationItem in careSituation\"\n                                        :key=\"careSituationItem.id\"\n                                        :value=\"careSituationItem.id\">\n                                        {{ careSituationItem.name }}\n                                </option>\n                              </select>\n                            </div>\n                            <div class=\"col-5\">\n                              <button type=\"button\" class=\"btn btn-outline-main-dark w-100 rounded-pill active\"\n                                      :disabled=\"disable.includes(careRecordWithMedicalRecordInfoIndex)\"\n                                      @click=\"confirmUpdate(careRecordWithMedicalRecordInfoItem, careRecordWithMedicalRecordInfoIndex)\">確定更新</button>\n                            </div>\n                          </div>\n\n                          <textarea class=\"form-control rounded-10 mb-2\"\n                                    placeholder=\"請輸入關心內容\"\n                                    rows=\"2\"\n                                    v-model=\"careRecordWithMedicalRecordInfoItem.careRecordComment\"\n                                    :disabled=\"disable.includes(careRecordWithMedicalRecordInfoIndex)\">\n                          </textarea>\n\n                          <template v-for=\"careFeedbackItem in careFeedback\"\n                                    :key=\"careFeedbackItem\">\n                            <div class=\"form-check form-check-inline\"\n                                v-if=\"careRecordWithMedicalRecordInfoItem.courseType === careFeedbackItem.courseType\">\n                              <input class=\"form-check-input\" type=\"checkbox\"\n                                    :disabled=\"disable.includes(careRecordWithMedicalRecordInfoIndex)\"\n                                    :id=\"careFeedbackItem.id + careRecordWithMedicalRecordInfoIndex\"\n                                    :value=\"careFeedbackItem.id\"\n                                    v-model=\"careRecordWithMedicalRecordInfoItem.careRecordFeedbackIdList\">\n                              <label class=\"form-check-label\"\n                                    :for=\"careFeedbackItem.id + careRecordWithMedicalRecordInfoIndex\">\n                                {{ careFeedbackItem.name }}\n                              </label>\n                            </div>\n                          </template>\n                        </div>\n\n                        <!-- 顯示 -->\n                        <div class=\"p-3 border-1 border-end border-top border-gray2 text-main-dark2\"\n                            style=\"width: 65.5%;\"\n                            v-else>\n                          <div class=\"mb-2\">\n                            <p class=\"mb-0 text-gray3\">關心狀況</p>\n                            <p class=\"mb-0\">\n                              {{ careSituation.find(item => item.id === careRecordWithMedicalRecordInfoItem.careSituation) ? careSituation.find(item => item.id === careRecordWithMedicalRecordInfoItem.careSituation).name : '無' }}</p>\n                          </div>\n\n                          <div class=\"mb-2\">\n                            <p class=\"mb-0 text-gray3\">關心內容</p>\n                            <p class=\"mb-0\">{{ careRecordWithMedicalRecordInfoItem.careRecordComment || '無' }}</p>\n                          </div>\n\n                        </div>\n                      </div>\n                    </div>\n\n                    <!-- 客戶溝通 -->\n                      <div class=\"p-3 border-1 border-end border-top border-gray2 text-main-dark2\" style=\"width: 19%;\">\n                        <div class=\"mb-2\">\n                          <p class=\"mb-0 text-gray3\">注意事項</p>\n                          <p class=\"mb-0\">{{ item.customer.attention || '無' }}</p>\n                        </div>\n\n                        <div class=\"mb-2\">\n                          <p class=\"mb-0 text-gray3\">治療習慣</p>\n                          <p class=\"mb-0\">{{ item.customer.habit || '無' }}</p>\n                        </div>\n\n                        <div>\n                          <p class=\"mb-0 text-gray3\">客戶分析</p>\n                          <p class=\"mb-0\">{{ item.customer.personality || '無' }}</p>\n                        </div>\n                      </div>\n\n                      <!-- 儲值及禮券剩餘 -->\n                      <div class=\"py-3 ps-3 pe-6 border-1 border-end border-top border-gray2 text-main-dark2\" style=\"width: 19%;\">\n                        <div class=\"mb-2\">\n                          <p class=\"mb-0 text-gray3\">儲值量</p>\n                          <div class=\"d-flex justify-content-between\"\n                              v-for=\"customerStoredValueItem in item.customerStoredValueData\"\n                              :key=\"customerStoredValueItem\">\n                            <p class=\"mb-0\">{{ customerStoredValueItem.quantity }}</p>\n                            <p class=\"mb-0\">{{ customerStoredValueItem.unit }}</p>\n                          </div>\n\n                          <p class=\"mb-0\" v-if=\"item.customerStoredValueData.length === 0\">無</p>\n                        </div>\n\n                        <div class=\"mb-2\">\n                          <p class=\"mb-0 text-gray3\">禮券(張)</p>\n                          <p class=\"mb-0\">\n                            <span v-for=\"(voucherDepositDataItem, index) in item.voucherDepositData\"\n                                  :key=\"voucherDepositDataItem\">\n                            {{ voucherDepositDataItem.voucherTypeId }} : {{voucherDepositDataItem.quantity }}\n\n                            <span v-if=\"item.voucherDepositData.length !== index + 1\"> / </span>\n                            </span>\n                          </p>\n                        </div>\n                      </div>\n\n                      <!-- 下次約診狀況 -->\n                      <div class=\"py-3 ps-3 pe-6 border-1 border-top border-gray2 text-main-dark2\" style=\"width: 19.1%;\">\n                        <div class=\"mb-2\"\n                            v-for=\"appointmentSituationDataItme in item.appointmentSituationData\"\n                            :key=\"appointmentSituationDataItme\">\n                          <p class=\"mb-0\">{{ convertTimeFormatSlash(appointmentSituationDataItme.appointmentDate) }} ({{ dateConversionWeek(appointmentSituationDataItme.appointmentDate) }}) {{ convertTimeFormatDeleteSecond(appointmentSituationDataItme.appointmentTime) }}</p>\n                          <p class=\"mb-0\">{{ appointmentSituationDataItme.courseName }} {{ appointmentSituationDataItme.operatorName }}</p>\n                          <p class=\"mb-0 text-gray3\">註: {{ appointmentSituationDataItme.comment || '無' }}</p>\n                        </div>\n                      </div>\n                  </div>\n                 \n                </div>\n              </div>\n\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- 客戶溝通 -->\n  <div class=\"modal fade\" ref=\"customerCommunicationModalRef\">\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content p-0 bg-transparent\">\n        <h5 class=\"mb-0 py-3 text-center fw-500 bg-main-dark1 text-white rounded-top-20\">客 戶 溝 通</h5>\n        <div class=\"bg-white text-main-dark2 pt-5 pb-3 px-10\">\n          <div class=\"mb-5\">\n            <h6 >注意事項 :</h6>\n            <textarea class=\"form-control rounded-10\" id=\"precautions\" placeholder=\"請輸入內容\" rows=\"3\"\n                      v-model=\"customerCommunicationData.attention\"></textarea>\n          </div>\n\n          <div class=\"mb-5\">\n            <h6 >治療習慣 :</h6>\n            <textarea class=\"form-control rounded-10\" id=\"precautions\" placeholder=\"請輸入內容\" rows=\"3\"\n                      v-model=\"customerCommunicationData.habit\"></textarea>\n          </div>\n\n          <div class=\"mb-3\">\n            <h6 >客戶分析 :</h6>\n            <textarea class=\"form-control rounded-10\" id=\"precautions\" placeholder=\"請輸入內容\" rows=\"3\"\n                      v-model=\"customerCommunicationData.personality\"></textarea>\n          </div>\n\n          <div class=\"row g-3 align-items-center\">\n            <div class=\"col-auto\">\n              <label for=\"customerTraits\" class=\"col-form-label\">客戶特質</label>\n            </div>\n            <div class=\"col-5\">\n              <select class=\"form-select rounded-pill\" id=\"customerTraits\"\n                      v-model=\"customerCommunicationData.trait\">\n                <option v-for=\"item in customerTrait\"\n                        :key=\"item.id\"\n                        :value=\"item.id\">\n                        {{ item.name}} : {{ item.description }}\n                </option>\n              </select>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"d-flex justify-content-end bg-white border-2 border-top rounded-bottom-20 border-gray2 py-2\">\n          <button type=\"button\" class=\"btn btn-alert-second rounded-pill me-2\" data-bs-dismiss=\"modal\">關 閉</button>\n          <button type=\"button\" class=\"btn btn-alert-main rounded-pill me-5\" @click=\"customerCommunicationConfirm()\">確 定</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- 發送簡訊 -->\n  <div class=\"modal fade\" ref=\"smsSampleModalRef\">\n    <div class=\"modal-dialog modal-760\">\n      <div class=\"modal-content p-0 bg-transparent\">\n        <h5 class=\"mb-0 py-3 text-center fw-500 bg-main-dark1 text-white rounded-top-20\">發 送 簡 訊</h5>\n        <div class=\"bg-white text-main-dark2 py-5 px-10\">\n          <div class=\"border border-gray2 bg-gray1 px-5 py-3 rounded-10 mb-5\">\n            <div class=\"row\">\n              <div class=\"col-6\">\n                <div class=\"d-flex align-items-center\">\n                  <h6 class=\"mb-0\">客戶資訊</h6>\n                  <!-- 美容師小名 -->\n                  <div class=\"ms-5\">\n                    <div class=\"bg-main-dark2 rounded-circle position-relative nickName-icon\">\n                      <span class=\"text-white position-absolute top-50 start-50 translate-middle\">\n                        {{ smsSampleCustomer.beautician }}\n                      </span>\n                    </div>\n                  </div>\n                  <!-- 客人名稱 -->\n                  <h6 class=\"mb-0 ms-2 fw-500 text-main-dark2\">{{ smsSampleCustomer.name }}</h6>\n                  <!-- 生日 -->\n                  <h6 class=\"mb-0 ms-3 text-main-dark2\">{{ smsSampleCustomer.birthday }}</h6>\n                </div>\n              </div>\n              <div class=\"col-6\">\n                <div class=\"d-flex\">\n                  <h6 class=\"mb-0\">連絡電話</h6>\n                  <h6 class=\"mb-0 ms-5\">{{ smsSampleCustomer.cellPhone }}</h6>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div>\n            <h6>注意事項 :</h6>\n            <textarea class=\"form-control rounded-10 mb-2\" id=\"precautions\" placeholder=\"請輸入內容\" rows=\"3\"\n                      v-model=\"smsRecordContent\"></textarea>\n\n            <div class=\"d-flex justify-content-between\">\n              <button type=\"button\" class=\"btn btn-outline-second2 rounded-pill\"\n                      @click=\"saveAsExample()\">儲存為範例</button>\n              \n              <div>\n                <button type=\"button\" class=\"btn btn-outline-second2 rounded-pill me-2\"\n                        @click=\"smsRecordContent = null\">清除內容</button>\n                <button type=\"button\" class=\"btn btn-outline-main-dark rounded-pill active\"\n                        @click=\"sendSmsRecord()\">發送簡訊</button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"bg-white border-2 border-top border-gray2 py-5 px-10\">\n          <h6>範例簡訊</h6>\n          <div class=\"border border-gray2 border-1 rounded-15\" style=\"min-height: 367px;\">\n            <p class=\"fw-500 text-main-dark2 text-center py-2 border-bottom border-gray2 mb-0\">訊息內容</p>\n              <!-- 範例簡訊開始 -->\n            \n            <div v-for=\"(employeeSmsSampleItem, employeeSmsSampleIndex) in employeeSmsSample\"\n                :key=\"employeeSmsSampleItem\"\n                @click=\"selectSmsSample(employeeSmsSampleIndex)\">\n              <div class=\"border-bottom border-gray2\"\n                  v-if=\"employeeSmsSampleItem.id !== editSmsSampleId\"\n                  :class=\"{ 'bg-gray1' : smsSampleIndex === employeeSmsSampleIndex }\">\n                <div class=\"py-2 px-5 d-flex align-items-center\">\n                  <img class=\"me-5\" src=\"@/assets/stylesheets/icon/Check-02.png\"\n                      width=\"15\"\n                      height=\"15\"\n                      alt=\"Check-02\"\n                      v-if=\"employeeSmsSampleItem.default\">\n\n                  <div v-else class=\"me-5\" style=\"width: 15px; height:15px;\"></div>\n\n                  <p class=\"mb-0 me-auto text-main-dark2\">{{ employeeSmsSampleItem.content }}</p>\n\n                <div class=\"d-flex\">\n                  <a href=\"#\" class=\"me-3\" @click.prevent=\"editSmsSample(employeeSmsSampleItem.id)\">\n                    <img class=\"align-middle\" src=\"@/assets/stylesheets/icon/edit-02.png\" alt=\"icon\" width=\"12.62\" height=\"12.67\">\n                  </a>\n\n                  <a href=\"#\">\n                    <img src=\"@/assets/stylesheets/icon/trash.png\" alt=\"icon\" width=\"13\" height=\"17\"\n                        @click.prevent=\"openDeleteSmsSampleModal(employeeSmsSampleItem)\">\n                  </a>\n                </div>\n              </div>\n            </div>\n\n              <div class=\"border-bottom border-gray2 bg-gray1\" v-else>\n                <div class=\"py-2 px-5 d-flex align-items-center\">\n                  <div class=\"me-5\" style=\"width: 15px; height:15px;\"></div>\n\n                  <div class=\"w-100\">\n                    <textarea class=\"form-control rounded-10 mb-2\"\n                              id=\"precautions\"\n                              placeholder=\"請輸入內容\"\n                              rows=\"2\"\n                              v-model=\"employeeSmsSampleItem.content\"></textarea>\n\n                    <div class=\"d-flex\">\n                      <div class=\"form-check me-auto\">\n                        <input class=\"form-check-input\" type=\"checkbox\" value=\"\" id=\"SetAsDefaultSMS\" v-model=\"employeeSmsSampleItem.default\">\n                        <label class=\"form-check-label text-gray3\" for=\"SetAsDefaultSMS\">\n                          設為預設簡訊\n                        </label>\n                      </div>\n\n                      <button type=\"button\" class=\"btn bg-white border border-main-dark2 text-main-dark2 rounded-pill me-2\"\n                              @click=\"employeeSmsSampleItem.content = null\">刪除訊息</button>\n                      <button type=\"button\" class=\"btn btn-outline-main-dark rounded-pill active\"\n                              @click=\"editCompleted(employeeSmsSampleItem)\">儲存編輯</button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n        </div>\n\n        <div class=\"d-flex justify-content-end bg-white border-2 border-top rounded-bottom-20 border-gray2 py-2\">\n          <button type=\"button\" class=\"btn btn-alert-second rounded-pill me-2\" data-bs-dismiss=\"modal\">關 閉</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- 刪除範例簡訊 -->\n  <div class=\"modal fade\" ref=\"deleteSmsSampleModalRef\">\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content p-0 bg-transparent\">\n        <h5 class=\"mb-0 py-3 text-center fw-500 bg-main-dark1 text-white rounded-top-20\">刪 除 範 例 簡 訊</h5>\n        <div class=\"bg-white text-main-dark2 py-5 px-10\">\n          <p class=\"text-center mb-5\">是否確認刪除此筆範例簡訊 ?</p>\n\n          <div class=\"py-2 px-5 border border-gray2 bg-gray1 rounded-10\">\n            <p class=\"mb-0\">{{ deleteSmsSample.content }}</p>\n          </div>\n        </div>\n\n        <div class=\"d-flex justify-content-end bg-white border-2 border-top rounded-bottom-20 border-gray2 py-2\">\n          <button type=\"button\" class=\"btn btn-alert-second rounded-pill me-2\" data-bs-dismiss=\"modal\"\n                  @click=\"cancelDeleteSmsSample()\">取 消</button>\n          <button type=\"button\" class=\"btn btn-alert-main rounded-pill me-5\"\n                  @click=\"deleteSmsSampleConfirm()\">確定刪除</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- 聯絡紀錄 -->\n  <div class=\"modal fade\" ref=\"contactRecordModelRef\">\n    <div class=\"modal-dialog modal-904\">\n      <div class=\"modal-content p-0 bg-transparent\">\n        <h5 class=\"mb-0 py-3 text-center fw-500 bg-main-dark1 text-white rounded-top-20\">聯 絡 紀 錄</h5>\n        \n        <div class=\"bg-white p-5\">\n\n          <div class=\"bg-gray1 border border-2 border-gray2 rounded-top-20 text-center text-gray3\">\n            <div class=\"d-flex border-1\">\n              <h6 class=\"mb-0 py-3\" style=\"width: 15%\">\n                治療日期\n              </h6>\n              <h6 class=\"mb-0 py-3 border-start border-gray2\" style=\"width: 15%\">\n                Call 客日期\n              </h6>\n              <h6 class=\"mb-0 py-3 border-start border-gray2\" style=\"width: 26%\">\n                狀 況\n              </h6>\n              <h6 class=\"mb-0 py-3 border-start border-gray2\" style=\"width: 34%\">\n                內 容\n              </h6>\n              <h6 class=\"mb-0 py-3 border-start border-gray2\" style=\"width: 10%\">\n                醫美師\n              </h6>\n            </div>\n          </div>\n\n          <div class=\"border border-2 border-top-0 border-gray2 rounded-bottom-20 text-main-dark2\">\n            <div class=\"d-flex\"\n                v-for=\"(item, index) in contactRecordByCustomer\"\n                :key=\"item\"\n                :class=\"{ 'border-1 border-bottom border-gray2' : index + 1 !== contactRecordByCustomer.length}\">\n              <h6 class=\"mb-0 py-3 text-center\" style=\"width: 15%\">\n                {{item.treatDate}}\n              </h6>\n              <h6 class=\"mb-0 py-3 border-1 border-start border-gray2 text-center\" style=\"width: 15%\">\n                {{item.contactDate}}\n              </h6>\n              <h6 class=\"mb-0 py-3 border-1 border-start border-gray2 px-4\" style=\"width: 26%\">\n                {{item.situation}}\n              </h6>\n              <h6 class=\"mb-0 py-3 border-1 border-start border-gray2 px-4\" style=\"width: 34%\">\n                {{ item.courseName }} : {{ item.content }}\n              </h6>\n              <h6 class=\"mb-0 py-3 border-1 border-start border-gray2 text-center\" style=\"width: 10%\">\n                {{ item.beauticianName }}\n              </h6>\n            </div>\n          </div>\n\n        </div>\n        <div class=\"d-flex align-items-center justify-content-end bg-white border-2 border-top rounded-bottom-20 border-gray2 py-4\">\n\n          <div>\n            <button type=\"button\" class=\"btn btn-alert-second rounded-pill me-5\" data-bs-dismiss=\"modal\">關 閉</button>\n          </div>\n        </div>\n\n      </div>\n    </div>\n  </div>\n\n  <!-- 歷史病歷 -->\n  <div class=\"modal fade\" ref=\"historicalMedicalRecordsRef\">\n    <div class=\"modal-dialog modal-904\">\n      <div class=\"modal-content p-0 bg-transparent\">\n        <h5 class=\"mb-0 py-3 text-center fw-500 bg-main-dark1 text-white rounded-top-20\">歷 史 病 歷</h5>\n        <div class=\"d-flex\">\n          <!-- 左邊 -->\n          <div class=\"border-start border-bottom border-main-dark1 bg-gray1 p-5\"\n              style=\"width: 33.1%; border-radius: 0px 0px 0px 10px;\">\n            <h6 class=\"mb-2 text-main-dark2\">病歷類型</h6>\n\n            <div class=\"bg-white rounded-15 border border-gray2 pt-2 pe-6 position-relative mb-3 cursor-pointer\"\n                style=\"min-height: 43px\"\n                @click.stop=\"openCourseTypeWindow()\">\n              <button type=\"button\" class=\"amis-badge amis-badge-second3 ms-2 mb-2\"\n                      v-for=\"item in courseTypeSelected\"\n                      :key=\"item.id\">\n                {{ item.name }}\n              </button>\n\n              <img class=\"position-absolute top-50 translate-middle-y\" style=\"right: 12px;\"\n                  src=\"@/assets/stylesheets/icon/arrow_down.png\" alt=\"arrow_down\" width=\"10\" height=\"4.62\">\n\n            <!-- 病歷類型下拉 -->\n              <div class=\"position-absolute bg-gray1 rounded-15 w-100 pt-5 pb-3 px-5 border border-1 border-gray3\"\n                    style=\"z-index: 10; top: 110%;\"\n                    v-show=\"courseTypeWindow\"\n                    data-to=\"true\"\n                    @click.stop=\"null\">\n                <div class=\"scroll-content-none\" style=\"max-height: 170px\">\n                  <div class=\"form-check mb-2\">\n                    <input class=\"form-check-input\" type=\"checkbox\"\n                          :value=\"{id: 'all', name: '全部'}\"\n                          id=\"all\"\n                          @change=\"selectCourseType()\"\n                          v-model=\"courseTypeSelected\">\n                    <label class=\"form-check-label text-main-dark2 d-block\" for=\"all\">\n                      全部\n                    </label>\n                  </div>\n\n                  <div class=\"form-check mb-2\"\n                      v-for=\"item in courseTypeData\" :key=\"item.id\">\n                    <input class=\"form-check-input\" type=\"checkbox\"\n                          :value=\"item\"\n                          :id=\"`courseType${item.id}`\"\n                          @change=\"selectCourseType()\"\n                          v-model=\"courseTypeSelected\">\n                    <label class=\"form-check-label text-main-dark2 d-block\" :for=\"`courseType${item.id}`\">\n                      {{ item.name }}\n                    </label>\n                  </div>\n\n                </div>\n              </div>\n            </div>\n\n            <div class=\"bg-white rounded-15 border border-gray2 pt-3 pb-2 px-2 mb-3\">\n              <h6 class=\"text-center text-main-dark2 mb-5\">病歷紀錄</h6>\n\n              <div class=\"text-gray3\">\n                <template v-for=\"(item, index) in historicalMedicalRecordOption\"\n                        :key=\"item\">\n                  <div class=\"row gx-0 border-top border-gray3 p-1\"\n                      :class=\"historicalMedicalRecordOptionFocusNum === index ? 'bg-main-dark1 text-white' : 'border-top border-gray3'\"\n                      v-if=\"(index + 1) <= (paginationFocusNum * 10) && (index + 1) >= (paginationFocusNum - 1) * 10 + 1\"\n                      @click=\"selectHistoricalMedicalRecord(index)\">\n                    <div class=\"col-5\">\n                      <p class=\"mb-0\">{{ item.appointmentDate }}</p>\n                    </div>\n                    <div class=\"col-4\">\n                      <p class=\"mb-0\">{{ item.courseNames }}</p>\n                    </div>\n                    <div class=\"col-3\">\n                      <p class=\"mb-0\">{{ item.operatorName }}</p>\n                    </div>\n                </div>\n                </template>\n\n              </div>\n            </div>\n\n            <div class=\"d-flex justify-content-between px-2\"\n                v-if=\"pagination.length !== 0\">\n              <span class=\"text-gray3\" style=\"font-size: 12px;\">\n                1-10 of {{ historicalMedicalRecordOption.length }}\n              </span>\n\n              <div>\n                <a href=\"#\" @click.prevent=\"previousPage()\">\n                  <img src=\"@/assets/stylesheets/icon/arrow_left.png\" width=\"4.12\" height=\"10\" alt=\"arrow_left\">\n                </a>\n\n                <template v-for=\"num in pagination\" :key=\"num\">\n                  <a href=\"#\" class=\"ms-4 align-middle\"\n                      @click.prevent=\"paginationFocusNum = num\"\n                      v-if=\"num <= maximumRange && num >= minimumRange\"\n                      :class=\"paginationFocusNum === num ? 'text-main-dark2' :'text-gray3 text-decoration-none'\">\n                    {{ num }}\n                  </a>\n                </template>\n\n                <span class=\"text-decoration-none ms-4 align-middle text-gray3\"\n                      v-if=\"pagination.length > 3\">\n                      ...\n                </span>\n\n                <a href=\"#\" class=\"text-decoration-none ms-4 align-middle text-gray3\"\n                  @click.prevent=\"goLastPage()\"\n                  v-if=\"pagination.length > 3\">\n                  {{ pagination.length }}\n                </a>\n\n                <a href=\"#\" class=\"ms-4\" @click.prevent=\"nextPage()\">\n                  <img src=\"@/assets/stylesheets/icon/arrow_right.png\" width=\"4.12\" height=\"10\" alt=\"arrow_right\">\n                </a>\n              </div>\n            </div>\n            \n          </div>\n\n          <!-- 右邊 -->\n          <div class=\"bg-white border-end border-bottom border-main-dark1\"\n              style=\"width: 66.9%; border-radius: 0px 0px 10px;\">\n            <div class=\"scroll-content-none\" style=\"max-height: 679px; min-height: 679px;\">\n              <div class=\"bg-white py-5 px-10\">\n                <div class=\"d-flex justify-content-end mb-2\">\n                  <button type=\"button\" class=\"btn btn-category rounded-pill ms-2 mb-2 btn-checkIcon\"\n                          v-for=\"(item, index) in historicalMedicalRecordTagData\"\n                          :key=\"item.medicalRecordId\"\n                          @click=\"selectHistoricalMedicalRecordTag(index)\"\n                          :class=\"{ 'active' : historicalMedicalRecordTagIndex === index }\">\n                          {{ item.courseTypeName }} : {{ item.courseName }}\n                  </button>\n                </div>\n\n                <div class=\"mb-3\">\n                  <div class=\"border border-gray2 bg-gray1 rounded-10 text-main-dark2 mb-3\">\n                    <div class=\"d-flex text-center\">\n                      <p class=\"mb-0 py-2 border-end border-gray2 fw-500\" style=\"width: 20%;\">券 號</p>\n                      <p class=\"mb-0 py-2 border-end border-gray2 fw-500\" style=\"width: 30%;\">收費明細</p>\n                      <p class=\"mb-0 py-2 px-5 border-end border-gray2 fw-500\" style=\"width: 20%;\">子療程</p>\n                      <p class=\"mb-0 py-2 px-5 fw-500\" style=\"width: 30%;\">拍照資料</p>\n                    </div>\n\n                    <div class=\"d-flex\">\n                      <div class=\"mb-0 py-3 px-4 border-end border-top border-gray2\" style=\"width: 20%;\">\n                        <div v-for=\"item in historicalMedicalRecordData.voucherOrder\"\n                            :key=\"item.bodyPartId\">\n                          <p class=\"fw-500 mb-0\">{{ item.bodyPartName }} :</p>\n                          <p class=\"mb-0\"\n                            v-for=\"voucherIdItem in item.voucherId\"\n                            :key=\"voucherIdItem\">\n                            {{ voucherIdItem }}\n                          </p>\n                        </div>\n                      </div>\n                      <div class=\"mb-0 py-3 px-4 border-end border-top border-gray2\" style=\"width: 30%;\">\n                        <!-- 收費明細 -->\n                        <template v-for=\"(feeDetailItem, index) in historicalMedicalRecordData.feeDetails\"\n                                  :key=\"feeDetailItem\">\n                          <div class=\"d-flex justify-content-between\"\n                              v-if=\"feeDetailItem.chargeType === 'anesthesia'\">\n                            <p class=\"mb-0\">{{index + 1}}. {{ feeDetailItem.chargeName }}</p>\n                            <p class=\"mb-0\">{{ feeDetailItem.price }}</p>\n                          </div>\n\n                          <div v-if=\"feeDetailItem.chargeType === 'cash'\">\n                            <p class=\"mb-0\">{{index + 1}}. {{ feeDetailItem.chargeName }}</p>\n                            <div class=\"d-flex justify-content-between ms-4\"\n                                v-for=\"item in feeDetailItem.data\"\n                                :key=\"item\">\n                              <p class=\"mb-0 text-gray3\">{{ item.bodyPartName }}</p>\n                              <p class=\"mb-0\">{{ item.price }}</p>\n                            </div>\n                          </div>\n                        </template>\n                      </div>\n                      <div class=\"mb-0 py-3 px-4 border-end border-top border-gray2\" style=\"width: 20%;\">\n                        <div class=\"d-flex\"\n                            v-for=\"item in historicalMedicalRecordData.subcourseData\"\n                            :key=\"item\">\n                          <p class=\"mb-0 me-2\">{{ item.subcourseName }}:</p>\n                          <p class=\"mb-0\">{{ item.beauticianName }}</p>\n                        </div>\n                      </div>\n                      <div class=\"mb-0 py-3 px-4 border-top border-gray2\" style=\"width: 30%;\">\n                        <div class=\"d-flex\">\n                          <p class=\"mb-0 me-1\">時間 :</p>\n                          <p class=\"mb-0\">10:26:28</p>\n                        </div>\n                        <div class=\"d-flex\">\n                          <p class=\"mb-0 me-1\">狀態 :</p>\n                          <p class=\"mb-0\">已歸檔</p>\n                        </div>\n                        <div class=\"d-flex\">\n                          <p class=\"mb-0 me-1\">攝影師 :</p>\n                          <p class=\"mb-0\">魏如如</p>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div class=\"text-main-dark2\">\n                  <div class=\"d-flex mb-3\">\n                    <p class=\"mb-0 me-1\">病歷備註 :</p>\n                    <p class=\"mb-0\">{{ historicalMedicalRecordData.comment || '無' }}</p>\n                  </div>\n\n                  <div class=\"d-flex mb-3\"\n                    v-if=\"historicalMedicalRecordData.courseType !== 'OPD'\">\n                    <p class=\"mb-0 me-1\">客戶需求 :</p>\n                    <p class=\"mb-0\"\n                      v-for=\"(item, index) in historicalMedicalRecordData.customerDemandNames\"\n                      :key=\"item + index\">\n                      <span>{{ item }}</span>\n                      <span v-if=\"historicalMedicalRecordData.customerDemandNames.length !== index + 1\">、</span>\n                    </p>\n                    <p class=\"mb-0\" v-if=\"historicalMedicalRecordData.customerDemandNames\">\n                      {{ historicalMedicalRecordData.customerDemandNames.length === 0 ? '無' : null }}\n                    </p>\n                  </div>\n\n                  <div class=\"d-flex mb-3\" v-if=\"historicalMedicalRecordData.courseType === 'MicroPlasticSurgery'\">\n                    <p class=\"mb-0 me-1\">美容耗材 :</p>\n                    <p class=\"mb-0\">{{ historicalMedicalRecordData.beautyConsumableId || '無' }}</p>\n                  </div>\n\n                  <div class=\"d-flex\">\n                    <p class=\"mb-0 me-1\">關心紀錄 :</p>\n                    <p class=\"mb-0\" v-if=\"historicalMedicalRecordData.careRecord\">\n                      <span>{{ historicalMedicalRecordData.careRecord.situation }}</span>\n                      <span v-if=\"historicalMedicalRecordData.careRecord.content\">\n                        / {{ historicalMedicalRecordData.careRecord.content }}\n                      </span>\n                    </p>\n                    <p v-else class=\"mb-0 text-gray3\">\n                      尚未關心\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"border-top border-2 border-gray2 bg-white py-5 px-10\">\n                <div class=\"form-check form-check-inline mb-3\">\n                  <input class=\"form-check-input\" type=\"checkbox\" id=\"noTreatment\"\n                        v-model=\"historicalMedicalRecordData.notTreat\"\n                        disabled>\n                  <label class=\"form-check-label\" for=\"noTreatment\">未治療</label>\n                </div>\n\n                <div class=\"d-flex mb-3\">\n                  <p class=\"mb-0 me-1\">主 訴 :</p>\n                  <p class=\"mb-0\">{{ historicalMedicalRecordData.subjectiveDescription }}</p>\n                </div>\n\n                <div class=\"d-flex mb-3\"\n                    v-if=\"historicalMedicalRecordData.courseType === 'IV'\">\n                  <p class=\"mb-0 me-1\" style=\"white-space: nowrap;\">診 斷 :</p>\n                  <p class=\"mb-0\">{{ historicalMedicalRecordData.diagnosis }}</p>\n                </div>\n\n                <div class=\"d-flex mb-3\"\n                    v-if=\"historicalMedicalRecordData.courseType === 'IV'\">\n                  <p class=\"mb-0 me-1\" style=\"white-space: nowrap;\">療 耗 :</p>\n                  <div>\n                    <p class=\"mb-0\">\n                      {{ historicalMedicalRecordData.treatmentConsume }}\n                    </p>\n                    <div class=\"col-auto\" v-if=\"historicalMedicalRecordData.doctorSigned\">\n                      <img :src=\"`${employeeStampData}`\" alt=\"\" width=\"80\" height=\"40\">\n                    </div>\n                  </div>\n                </div>\n\n                <div class=\"border-1 text-gray3\">\n                  <!-- 麻藥紀錄 -->\n                  <div v-if=\"historicalMedicalRecordData.courseType === 'Laser' || historicalMedicalRecordData.courseType === 'MicroPlasticSurgery'\">\n                    <p class=\"fw-500 mb-2\">麻藥紀錄 :</p>\n                    <div class=\"border border-gray2 rounded-10 mb-3 text-gray3\">\n                      <div class=\"d-flex text-center\">\n                        <p class=\"mb-0 py-2 border-end border-gray2 fw-500\" style=\"width: 20%;\">麻藥名稱</p>\n                        <p class=\"mb-0 py-2 border-end border-gray2 fw-500\" style=\"width: 30%;\">劑 量</p>\n                        <p class=\"mb-0 py-2 px-5 border-end border-gray2 fw-500\" style=\"width: 20%;\">施打時間</p>\n                        <p class=\"mb-0 py-2 px-5 fw-500\" style=\"width: 30%;\">施打護理師</p>\n                      </div>\n\n                      <div class=\"d-flex text-center text-main-dark2\"\n                          v-for=\"item in historicalMedicalRecordData.anestheticUsageRecordData\"\n                          :key=\"item\">\n                        <div class=\"mb-0 py-3 px-4 border-end border-top border-gray2\" style=\"width: 20%;\">{{ item.anestheticName }}</div>\n                        <div class=\"mb-0 py-3 px-4 border-end border-top border-gray2\" style=\"width: 30%;\">{{ item.dose }}cc</div>\n                        <div class=\"mb-0 py-3 px-4 border-end border-top border-gray2\" style=\"width: 20%;\">{{ deleteTTimeFormat(item.createdTime).time }}</div>\n                        <div class=\"mb-0 py-3 px-4 border-top border-gray2\" style=\"width: 30%;\">{{ item.beauticianName }}</div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <!-- 雷射能量 -->\n                  <div v-if=\"historicalMedicalRecordData.courseType === 'Laser'\">\n                    <p class=\"fw-500 mb-2\">雷射能量 :</p>\n                    <div class=\"border border-gray2 rounded-10 mb-3 text-gray3\">\n                      <div class=\"d-flex text-center\">\n                        <p class=\"mb-0 py-2 border-end border-gray2 fw-500\" style=\"width: 16%;\">設備名稱</p>\n                        <p class=\"mb-0 py-2 border-end border-gray2 fw-500\" style=\"width: 32%;\">診 斷</p>\n                        <p class=\"mb-0 py-2 px-5 fw-500\" style=\"width: 52%;\">能 量</p>\n                      </div>\n\n                      <div class=\"d-flex\" v-for=\"laserRecordItem in laserRecord\" :key=\"laserRecordItem\">\n                        <div class=\"mb-0 border-end border-top border-gray2 text-center py-3\" style=\"width: 16%;\">\n                          <p class=\"mb-0 text-main-dark2\">{{ laserRecordItem.laserEquipmentName }}</p>\n                        </div>\n                        <div class=\"d-flex flex-wrap mb-0 p-3 border-end border-top border-gray2\" style=\"width: 32%;\">\n                          <p class=\"mb-0 text-main-dark2\"\n                            v-for=\"(item, index) in laserRecordItem.parts\"\n                            :key=\"item + index\">\n                            {{ item }} <span v-if=\"laserRecordItem.diagnosticSymptoms.length !== index + 1 && laserRecordItem.diagnosticSymptoms.length !== 0\">、</span>\n                          </p>\n\n                          <p class=\"mb-0 text-main-dark2\"\n                            v-for=\"(item, index) in laserRecordItem.diagnosticSymptoms\"\n                            :key=\"item + index\">\n                            {{ item }} <span v-if=\"laserRecordItem.diagnosticSymptoms.length !== index + 1\">、</span>\n                          </p>\n                        </div>\n                        <div class=\"d-flex mb-0 p-3 border-top border-gray2\" style=\"width: 52%;\">\n                          <div class=\"d-flex flex-wrap align-items-center\">\n                            <template v-for=\"(item, index) in laserRecordItem.laserRecordDetailData\" :key=\"item\">\n                              <span>\n                                <span class=\"text-mark\">{{ item.value }}</span>\n                                <span class=\"text-main-dark2\">{{ item.laserEquipmentFeatureUnit }}</span>\n                              </span>\n\n                              <span class=\"mx-1\" v-if=\"laserRecordItem.laserRecordDetailData.length !== index + 1\">/</span>\n\n                              <div class=\"d-flex align-items-center\" v-if=\"item.laserEquipmentFeatureId === 'Refrigerant1'\">\n                                <div>\n                                  <p class=\"mb-0 text-mark\">{{ laserRecordItem.Refrigerant1 }}</p>\n                                  <p class=\"mb-0 text-mark\">{{ laserRecordItem.Refrigerant2 }}</p>\n                                </div>\n                                <span class=\"mx-1\" v-if=\"laserRecordItem.laserRecordDetailData.length !== index + 1\"> / </span>\n                              </div>\n\n                            </template>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div v-if=\"historicalMedicalRecordData.courseType === 'Laser'\">\n                    <p class=\"fw-500 mb-2\">醫師詳答 :</p>\n                    <div class=\"border border-gray2 rounded-10 mb-3 text-gray3\">\n                      <div class=\"d-flex text-center\">\n                        <p class=\"mb-0 py-2 border-end border-gray2 fw-500\" style=\"width: 25%;\">雷射能量</p>\n                        <p class=\"mb-0 py-2 border-end border-gray2 fw-500\" style=\"width: 25%;\">能量等級</p>\n                        <p class=\"mb-0 py-2 px-5 border-end border-gray2 fw-500\" style=\"width: 25%;\">下次治療建議</p>\n                        <p class=\"mb-0 py-2 px-5 fw-500\" style=\"width: 25%;\">下次建議時間</p>\n                      </div>\n\n                      <div class=\"d-flex text-center\">\n                        <div class=\"mb-0 py-3 px-4 border-end border-top border-gray2\"\n                            style=\"width: 25%;\"\n                            v-for=\"item in historicalMedicalRecordData.doctorDetailAnswerData\"\n                            :key=\"item.groupId\">\n                          <p class=\"mb-0 text-main-dark2\">{{ item.itemContent }}</p>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"text-main-dark2\">\n                    <div class=\"d-flex mb-3\" v-if=\"historicalMedicalRecordData.courseType !== 'IV'\">\n                      <p class=\"mb-0 me-1\">諮詢估量 :</p>\n                      <p class=\"mb-0\">{{ historicalMedicalRecordData.estimate || '無' }}</p>\n                    </div>\n                    <div class=\"d-flex mb-3\" v-if=\"historicalMedicalRecordData.courseType !== 'IV'\">\n                      <p class=\"mb-0 me-1\">醫師醫囑 :</p>\n                      <p class=\"mb-0\">{{ historicalMedicalRecordData.advisory || '無' }}</p>\n                    </div>\n                  </div>\n\n                  <p class=\"fw-500 mb-2\">醫師確認 :</p>\n                  <div class=\"border border-gray2 rounded-10 mb-3\">\n                    <div class=\"d-flex\" v-if=\"historicalMedicalRecordData.courseType === 'Laser' || historicalMedicalRecordData.courseType === 'MicroPlasticSurgery'\">\n                      <p class=\"mb-0 py-2 border-end border-gray2 fw-500 text-gray3 text-center\" style=\"width: 25%;\">修護霜 R</p>\n                      <div class=\"py-2 px-4 border-end border-gray2 fw-500 text-main-dark2\" style=\"width: 75%;\">\n                        <template v-if=\"historicalMedicalRecordData.repairCreamPrescribeMedicineRecords\">\n                          <p v-if=\"historicalMedicalRecordData.repairCreamPrescribeMedicineRecords.length === 0\"\n                            class=\"mb-0\">\n                            不拿R\n                          </p>\n                        \n                          <div class=\"d-flex\" v-else>\n                            <p class=\"mb-0\"\n                              v-for=\"(item, index) in historicalMedicalRecordData.repairCreamPrescribeMedicineRecords\"\n                              :key=\"item\">{{ item.medicineName }} *{{ item.amount }}\n                              <span v-if=\"historicalMedicalRecordData.repairCreamPrescribeMedicineRecords.length > 1 && historicalMedicalRecordData.repairCreamPrescribeMedicineRecords.length !== index + 1\">、</span>  \n                            </p>\n                          </div>\n                        </template>\n                      </div>\n                    </div>\n\n                    <div class=\"d-flex\">\n                      <div class=\"mb-0 py-3 px-4 border-end border-gray2\" style=\"width: 25%;\"\n                          :class=\"{ 'border-top' : historicalMedicalRecordData.courseType === 'Laser' || historicalMedicalRecordData.courseType === 'MicroPlasticSurgery'}\">\n                        <p class=\"mb-0 text-main-dark2 text-center text-gray3\">是否開藥</p>\n                      </div>\n                      <div class=\"mb-0 py-3 px-4 border-end border-gray2\" style=\"width: 75%;\"\n                          :class=\"{ 'border-top' : historicalMedicalRecordData.courseType === 'Laser' || historicalMedicalRecordData.courseType === 'MicroPlasticSurgery'}\">\n                        <div class=\"text-gray3 mb-2\">\n                          <p class=\"mb-0\"\n                            v-for=\"item in historicalMedicalRecordData.prescribeMedicineRecords\"\n                            :key=\"item\">\n                            {{ item.medicineTypeName }} - {{ item.medicineName }}, 天數 : {{ item.amount }}<span v-if=\"item.takeMedicineFrequencyName\">, {{ item.takeMedicineFrequencyName }}</span>\n                          </p>\n                        </div>\n\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"row gx-3 text-main-dark2 mb-3\"\n                      v-if=\"historicalMedicalRecordData.courseType === 'Laser'\">\n                    <div class=\"col-auto\">\n                      <div class=\"form-check\">\n                        <input class=\"form-check-input\" type=\"checkbox\" id=\"defaultCheck\"\n                              v-model=\"historicalMedicalRecordData.cancelled\"\n                              disabled>\n                        <label class=\"form-check-label\" for=\"defaultCheck\">\n                          醫師免單\n                        </label>\n                      </div>\n                    </div>\n                    <div class=\"col-7\">\n                      <p class=\"mb-0\">{{ historicalMedicalRecordData.reason }}</p>\n                    </div>\n                  </div>\n\n                  <div class=\"row gx-3 text-main-dark2\"\n                      v-if=\"historicalMedicalRecordData.courseType !== 'IV'\">\n                    <div class=\"col-auto\">\n                      <div class=\"form-check\">\n                        <input class=\"form-check-input\" type=\"checkbox\" id=\"defaultCheck1\"\n                              v-model=\"historicalMedicalRecordData.doctorSigned\"\n                              disabled>\n                        <label class=\"form-check-label\" for=\"defaultCheck1\">\n                          醫師確認\n                        </label>\n                      </div>\n                    </div>\n                    <div class=\"col-auto\" v-if=\"historicalMedicalRecordData.doctorSigned\">\n                      <img :src=\"`${employeeStampData}`\" alt=\"\" width=\"80\" height=\"40\">\n                    </div>\n                  </div>\n\n                </div>\n\n              </div>\n            </div>\n            <div class=\"d-flex align-items-center justify-content-end bg-white rounded-bottom-20 border-2 border-top border-gray2 py-4 pe-10\">\n\n              <button type=\"button\" class=\"btn btn-alert-second rounded-pill\" data-bs-dismiss=\"modal\">關 閉</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n</template>\n\n<script setup>\n  import { inject, nextTick, onMounted, ref, toRefs } from 'vue';\n  import { Modal } from 'bootstrap';\n\n  const accordions = inject('accordion');\n  const {\n    accordionToggle,\n  } = accordions;\n\n  const alertMessage = inject('alertMessage');\n  const { updateMessage } = alertMessage;\n\n  const textConversionTool = inject('textConversionTool');\n\n  const {\n    convertTimeFormatDeleteSecond,\n    deleteTTimeFormat,\n    convertTimeFormatSlash,\n    dateConversionWeek,\n    } = textConversionTool;\n\n  const fetchFunction = inject('fetchFunction');\n\n  const {\n    fetchApi,\n    getTokenFromCookie\n  } = fetchFunction;\n\n  const Employee = inject('Employee');\n\n  const {\n    employeeState,\n    getBeauticiansAAForCare,\n    getAllDoctorData,\n    getBeauticians,\n  } = Employee;\n\n  const {\n    beauticiansAAForCareData,\n    allDoctorData,\n    beauticiansData\n    } = toRefs(employeeState);\n\n  const courseType = inject('courseType');\n\n  const {\n    courseTypeState,\n    getCourseTypeData,\n  } = courseType;\n\n  const {\n    courseTypeData\n  } = toRefs(courseTypeState);\n\n  /** 手風琴 accordion data */\n  const accordion = ref({\n    toggleCustomerData: [\n      { \n        className: '.toggle-customerData',\n        maxHeight: null\n      },\n      { \n        className: '.toggle-customerData-icon',\n        style: 'transform',\n        open: 'rotate(180deg)',\n        close: 'rotate(0deg)'\n      }\n    ],\n  })\n\n  // 搜尋(左邊)\n  const loggedInBeautician = ref(null); // 登入醫美師\n\n  const searchCareData = ref({\n    beauticianId: null,\n    courseType: null,\n    operatorId: null,\n    cared: false,\n    startDate: null,\n    endDate: null,\n    customerName: null,\n    customerCellPhone: null,\n    customerBirthday: null,\n  });\n\n  const careData = ref([]);\n  const caredTextJudge = ref(false);\n\n  /** 搜尋關心資料 */\n  async function careRecordSearchCareData() {\n\n    let url = `/api/CareRecord/SearchCareData`;\n\n    const key = Object.keys(searchCareData.value);\n\n    key.forEach(item => {\n      if (searchCareData.value[item] !== null) {\n        if (!url.includes('?')) {\n          url += `?${item}=${searchCareData.value[item]}`;\n          return null;\n        }\n\n        url += `&${item}=${searchCareData.value[item]}`;\n      }\n    })\n\n    console.log(url);\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET',\n    };\n\n    const response = await fetchApi(url, options);\n\n    careData.value = response.data;\n\n    nextTick(() => {\n      if (careData.value.length !== 0) {\n        accordionToggle(0, accordion.value.toggleCustomerData);\n      }\n    })\n\n    disable.value = [];\n\n    caredTextJudge.value = searchCareData.value.cared;\n  }\n\n  /** 關心完成 或 尚未關心 的筆數 */\n  function careDataLength() {\n\n    let num = 0;\n\n    if (!careData.value) return null;\n\n    careData.value.forEach(item => {\n      num += item.careRecordWithMedicalRecordInfo.length;\n    })\n\n    return num;\n  }\n\n  /** 重置搜尋關心資料 */\n  function resetCareRecordSearchCareData() {\n\n    searchCareData.value = {\n      beauticianId: null,\n      courseType: null,\n      operatorId: null,\n      cared: false,\n      startDate: null,\n      endDate: null,\n      customerName: null,\n      customerCellPhone: null,\n      customerBirthday: null,\n    }\n\n    const judge = beauticiansAAForCareData.value.some(item => item.id === loggedInBeautician.value.employeeId);\n\n    if (judge) {\n      searchCareData.value.beauticianId = loggedInBeautician.value.employeeId;\n    } else {\n      searchCareData.value.beauticianId = beauticiansAAForCareData.value[0].id;\n    }\n  }\n\n  // 客戶溝通\n  const customerCommunicationModalRef = ref(null);\n  let customerCommunicationModal;\n\n  const customerCommunicationData = ref({});\n\n  onMounted(() => {\n    customerCommunicationModal = new Modal(customerCommunicationModalRef.value);\n  })\n\n  /** 開啟客戶溝通 */\n  async function openCustomerCommunicationModal(item) {\n    await getCustomerTraitAll();\n    const response = await getCustomerById(item.customer.id);\n\n    const {\n      attention,\n      habit,\n      personality,\n      trait\n    } = response.data;\n    \n    customerCommunicationData.value = {\n      customerId: item.customer.id,\n      attention,\n      habit,\n      personality,\n      trait\n    }\n\n    customerCommunicationModal.show();\n  }\n\n  /** 客戶溝通確認 - 更新客戶溝通相關的資料 */\n  async function customerCommunicationConfirm() {\n    const url = '/api/Customer/UpdateCustomerCommunication';\n    \n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'PATCH',\n      body: JSON.stringify(customerCommunicationData.value),\n    };\n\n    const response = await fetchApi(url, options);\n\n    updateMessage(response.message);\n\n    if (response.statusCode >= 400) return null;\n\n    await careRecordSearchCareData();\n\n    customerCommunicationModal.hide();\n  }\n\n  /** 根據代號取得客戶 */\n  async function getCustomerById(customerId) {\n    const url = `/api/Customer/GetById?id=${customerId}`;\n    \n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET',\n    };\n\n    return await fetchApi(url, options);\n  }\n\n  const customerTrait = ref([]);\n\n  /** 取得所有客戶特質 */\n  async function getCustomerTraitAll() {\n    const url = `/api/CustomerTrait/GetAll`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET',\n    };\n\n    const response = await fetchApi(url, options);\n\n    customerTrait.value = response.data;\n  }\n\n  /** 開啟關心內容修改 */\n  function editCareRecord(customerId) {\n    editSign.value = customerId;\n  }\n\n  const disable = ref([]);\n\n  /** 關心內容 - 新增關心紀錄 or 更新關心紀錄 */\n  async function confirmUpdate(item, index) {\n    \n    // 已更新過的資料，disable\n\n    let method = 'POST';\n\n    let data = {\n      medicalRecordId: item.medicalRecordId,\n      situation: item.careSituation,\n      comment: item.careRecordComment,\n      careFeedbackIdList: item.careRecordFeedbackIdList,\n    }\n\n    if (item.careRecordId) {\n      method = 'PATCH';\n      data = {\n        id: item.careRecordId,\n        situation: item.careSituation,\n        comment: item.careRecordComment,\n        careFeedbackIdList: item.careRecordFeedbackIdList,\n      }\n    }\n\n    const url = `/api/CareRecord`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method,\n      body: JSON.stringify(data),\n    };\n\n    const response = await fetchApi(url, options);\n\n    updateMessage(response.message);\n\n    if (response.statusCode >= 400) return null;\n\n    disable.value.push(index);\n\n    editSign.value = null;\n\n    if (method === 'POST') {\n      const updateCareRecordData = await getCareRecordByMedicalRecord(item.medicalRecordId);\n      const {\n        careRecordFeedbackIdList,\n        id,\n        situation,\n        comment,\n      } = updateCareRecordData;\n\n      careData.value.forEach(t => {\n        t.careRecordWithMedicalRecordInfo.forEach(t2 => {\n          if (t2.medicalRecordId === item.medicalRecordId) {\n            t.careRecordFeedbackIdList = careRecordFeedbackIdList;\n            t.careRecordId = id;\n            t.careSituation = situation;\n            t.careRecordComment = comment;\n          }\n        })\n      })\n    }\n  }\n\n  /** 取得病歷對應的關心紀錄 */\n  async function getCareRecordByMedicalRecord(medicalRecordId) {\n    const url = `/api/CareRecord/GetByMedicalRecord?medicalRecordId=${medicalRecordId}`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: \"GET\"\n    };\n\n    const response = await fetchApi(url, options);\n\n    return response.data;\n  }\n\n  // 發送簡訊\n  const smsSampleModalRef = ref(null);\n  let smsSampleModal;\n\n  onMounted(() => {\n    smsSampleModal = new Modal(smsSampleModalRef.value);\n  })\n\n  const employeeSmsSample = ref([]);\n\n  /** 取得員工對應的簡訊範例 */\n  async function getByEmployeeSmsSample() {\n\n    const url = `/api/SmsSample/GetByEmployee`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET',\n    };\n\n    const response = await fetchApi(url, options);\n\n    employeeSmsSample.value = response.data;\n  }\n\n  const smsSampleCustomer = ref({});\n\n  let smsSampleCustomerId;\n\n  /** 開啟發送簡訊 */\n  async function openSmsSampleModal(id) {\n    smsSampleCustomerId = id;\n    const response = await getCustomerById(id);\n    await getBeauticians();\n    await getByEmployeeSmsSample();\n\n    smsRecordContent.value = null;\n    smsSampleIndex.value = 0;\n\n    // 取出預設簡訊\n    if (employeeSmsSample.value.length !== 0) {\n      smsRecordContent.value = employeeSmsSample.value.find(item => item.default).content;\n    }\n\n    editSmsSampleId.value = null;\n\n    smsSampleCustomer.value = response.data;\n\n    smsSampleCustomer.value.beautician = beauticiansData.value.find(item => item.id === smsSampleCustomer.value.beautician).nickname;\n\n    smsSampleModal.show();\n  }\n\n  const editSmsSampleId = ref(null);\n\n  /** 修改範例簡訊 */\n  function editSmsSample(id) {\n    editSmsSampleId.value = id;\n  }\n\n  const deleteSmsSampleModalRef = ref(null);\n  let deleteSmsSampleModal;\n\n  onMounted(() => {\n    deleteSmsSampleModal = new Modal(deleteSmsSampleModalRef.value);\n  })\n\n  const smsRecordContent = ref(null);\n\n  /** 傳送簡訊 */\n  async function sendSmsRecord() {\n\n    const url = `/api/SmsRecord`;\n\n    const data = {\n      customerId: smsSampleCustomer.value.id,\n      content: smsRecordContent.value,\n    }\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'POST',\n      body: JSON.stringify(data),\n    };\n\n    const response = await fetchApi(url, options);\n\n    updateMessage(response.message);\n  }\n\n  /** 儲存為範例 */\n  async function saveAsExample() {\n    if (!smsRecordContent.value) return null;\n\n    const url = `/api/SmsSample`;\n\n    const data = {\n      content: smsRecordContent.value,\n      default: true\n    }\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'POST',\n      body: JSON.stringify(data),\n    };\n\n    const response = await fetchApi(url, options);\n\n    updateMessage(response.message);\n\n    if (response.statusCode >= 400) return null;\n\n    await getByEmployeeSmsSample();\n  }\n\n  /** 儲存編輯 */\n  async function editCompleted(item) {\n    const url = `/api/SmsSample`;\n\n    const data = {\n      id: item.id,\n      content: item.content,\n      default: item.default\n    }\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'PATCH',\n      body: JSON.stringify(data),\n    };\n\n    const response = await fetchApi(url, options);\n\n    updateMessage(response.message);\n\n    if (response.statusCode >= 400) return null;\n\n    editSmsSampleId.value = null;\n\n    await getByEmployeeSmsSample();\n  }\n\n  const deleteSmsSample = ref({});\n\n  /** 開啟刪除範例簡訊 */\n  function openDeleteSmsSampleModal(item) {\n    deleteSmsSample.value = item;\n    \n    deleteSmsSampleModal.show();\n    smsSampleModal.hide();\n  }\n\n  /** 確認刪除範例簡訊 */\n  async function deleteSmsSampleConfirm() {\n    const url = `/api/SmsSample?id=${deleteSmsSample.value.id}`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'DELETE',\n    };\n\n    const response = await fetchApi(url, options);\n\n    updateMessage(response.message);\n\n    if (response.statusCode >= 400) return null;\n\n    openSmsSampleModal(smsSampleCustomerId);\n    deleteSmsSampleModal.hide();\n  }\n\n  /** 取消刪除範例簡訊 */\n  function cancelDeleteSmsSample() {\n    openSmsSampleModal(smsSampleCustomerId);\n    deleteSmsSampleModal.hide();\n  }\n\n  const smsSampleIndex = ref(0);\n\n  /** 選擇簡訊內容 */\n  function selectSmsSample(index) {\n    smsSampleIndex.value = index;\n    smsRecordContent.value = employeeSmsSample.value[index].content;\n  }\n\n  // 歷史病歷\n\n  const historicalMedicalRecordsRef = ref(null);\n  let historicalMedicalRecordsRefModel;\n\n  onMounted(() => {\n    historicalMedicalRecordsRefModel = new Modal(historicalMedicalRecordsRef.value);\n  })\n\n  const historicalMedicalRecordOption = ref([]);\n  const historicalMedicalRecordOptionFocusNum = ref(0);\n\n  const courseTypeSelected = ref([]);\n  const courseTypeWindow = ref(false);\n\n  const pagination = ref([]);  // 分頁\n  const maximumPages = ref(0); // 最大頁數\n\n  const minimumRange = ref(1); // 分頁最小範圍\n  const maximumRange = ref(3); // 分頁最大範圍\n\n  const paginationFocusNum = ref(1);\n\n  const laserRecord = ref([]);\n\n  /** 取得客戶歷史病歷選項資料  */\n  async function getHistoricalMedicalRecordOption(courseTypeArr, customerId) {\n    let url = `/api/MedicalRecord/GetHistoricalMedicalRecordOption?customerId=${customerId}`;\n    \n    courseTypeArr.forEach(item => {\n      url+=`&courseTypeIdList=${item.id}`\n    })\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET'\n    }\n\n    const response = await fetchApi(url, options);\n\n    historicalMedicalRecordOption.value = response.data;\n  }\n\n  const paginationFocusPage = ref(1);\n  let historicalMedicalRecordCustomerId = '';\n\n  /** 開啟歷史病歷 */\n  const openHistoricalMedicalRecordsRefModal = async (itme) => {\n    historicalMedicalRecordCustomerId = itme.customer.id;\n\n    await getCourseTypeData();\n    await getHistoricalMedicalRecordOption(courseTypeData.value, historicalMedicalRecordCustomerId);\n\n    historicalMedicalRecordOptionFocusNum.value = 0;\n    courseTypeSelected.value = [];\n    paginationFocusPage.value = 1;\n    \n    minimumRange.value = 1;\n    maximumRange.value = 3;\n\n    paginationFocusNum.value = 1;\n\n    courseTypeSelected.value.push({id: 'all', name: '全部'});\n\n    initPagination();\n    selectHistoricalMedicalRecord(0);\n\n    historicalMedicalRecordsRefModel.show();\n  }\n\n  /** 開啟病歷類型下拉選單 */\n  const openCourseTypeWindow = () => {\n    if (courseTypeWindow.value) return null;\n    courseTypeWindow.value = true;\n\n    function close() {\n      courseTypeWindow.value = false;\n      document.removeEventListener('click', close);\n    }\n\n    document.addEventListener('click', close);\n  }\n\n  /** 選擇病歷類型 */\n  async function selectCourseType() {\n\n    let idArr = courseTypeSelected.value.map(item => item.id);\n\n    if (idArr.some(item => item === 'all' || idArr.length === 0)) {\n      await getHistoricalMedicalRecordOption(courseTypeData.value, historicalMedicalRecordCustomerId);\n      return null;\n    }\n\n    await getHistoricalMedicalRecordOption(courseTypeSelected.value, historicalMedicalRecordCustomerId);\n  }\n\n  const historicalMedicalRecordTagData = ref([]); // 歷史病歷的標籤資料\n  const historicalMedicalRecordTagIndex = ref(0); // 歷史病歷的標籤 index\n\n  /** 選擇歷史病歷的標籤 */\n  function selectHistoricalMedicalRecordTag(index) {\n    historicalMedicalRecordTagIndex.value = index;\n\n    getHistoricalMedicalRecordData(historicalMedicalRecordTagData.value[index].medicalRecordId);\n  }\n\n  /** 取得歷史病歷的標籤資料 */\n  async function getHistoricalMedicalRecordTagData(historicalMedicalRecord) {\n\n    const {\n      appointmentDate,\n      courseType,\n      operatorId,\n    } = historicalMedicalRecord;\n\n    const url = `/api/MedicalRecord/GetHistoricalMedicalRecordTagData?customerId=${historicalMedicalRecordCustomerId}&courseType=${courseType}&date=${appointmentDate}&operatorId=${operatorId}`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET'\n    }\n\n    const response = await fetchApi(url, options);\n\n    historicalMedicalRecordTagData.value = response.data;\n\n    historicalMedicalRecordTagIndex.value = 0;\n\n    getHistoricalMedicalRecordData(historicalMedicalRecordTagData.value[historicalMedicalRecordTagIndex.value].medicalRecordId);\n  }\n\n  const historicalMedicalRecordData = ref({}); // 歷史病歷資料\n\n  /** 取得歷史病歷資料 */\n  async function getHistoricalMedicalRecordData(medicalRecordId) {\n\n    const url = `/api/MedicalRecord/GetHistoricalMedicalRecordData?medicalRecordId=${medicalRecordId}`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET'\n    }\n\n    const response = await fetchApi(url, options);\n\n    historicalMedicalRecordDataCollation(response.data);\n  }\n\n  const employeeStampData = ref('');\n\n  /** 取得員工的簽章資料 */\n  async function getEmployeeStampData(employeeId) {\n    const url = `/api/MedicalRecord/GetEmployeeStampData?employeeId=${employeeId}`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET'\n    }\n\n    const response = await fetchApi(url, options);\n\n    employeeStampData.value = response.data;\n  }\n\n  /** 歷史病歷資料整理 */\n  function historicalMedicalRecordDataCollation(response) {\n\n    getEmployeeStampData(response.medicalRecord.operator);\n\n    const {\n      voucherOrderDetails,\n      subcourseData,\n      medicalRecord,\n      anestheticOrderDetail,\n      coursePartOrderDetails,\n      bodyPartsOptions,\n      careRecord,\n      repairCreamPrescribeMedicineRecords,\n      prescribeMedicineRecords,\n      doctorFreeRecord,\n      customerDemandNames,\n      laserRecordRelativeData,\n      anestheticUsageRecordData,\n      doctorDetailAnswerData,\n    } = response;\n\n    // 療程專用卷 - 整理\n    let voucherOrder = voucherOrderDetails.map(itemA => {\n      const bodyPartName = response.bodyPartsOptions.find(itemB => itemA.bodyPartId === itemB.id);\n\n      return {\n        bodyPartId: itemA.bodyPartId,\n        bodyPartName: bodyPartName ? bodyPartName.name : null,\n        voucherId: [],\n      }\n    })\n\n    voucherOrderDetails.forEach(itemA => {\n      voucherOrder.forEach(itemB => {\n        if (itemA.bodyPartId === itemB.bodyPartId) {\n          itemB.voucherId.push(itemA.voucherId);\n        }\n      })\n    })\n\n    // 收費明細\n\n    let feeDetails = [];\n\n    // 收費明細 - 麻藥費用\n    if (medicalRecord.anesthesiaSituation === \"Anesthesia\") {\n      feeDetails.push({\n        chargeType: 'anesthesia',\n        chargeName: '麻藥費用',\n        anesthesiaSituation: \"Anesthesia\",\n        price: anestheticOrderDetail.price === 0 ? '免費' : anestheticOrderDetail.price,\n      });\n    }\n    // 收費明細 - 現金收費\n\n    // 單次 - 一般部位\n\n    const onceData = {\n      chargeType: 'cash',\n      chargeName: '單次費用',\n      data: [],\n    }\n\n    coursePartOrderDetails.forEach(item => {\n      if (item.priceType === 'Once' && item.bodyPartId !== \"Other\") {\n        const bodyPartName = bodyPartsOptions.find(itemA => itemA.id === item.bodyPartId);\n        onceData.data.push({\n          bodyPartName: bodyPartName ? bodyPartName.name : null,\n          price: item.price,\n        });\n      }\n    })\n\n    // 單次 - 其他部位\n    coursePartOrderDetails.forEach(item => {\n      if (item.priceType === 'Once' && item.bodyPartId == \"Other\") {\n        onceData.data.push({\n          bodyPartName: `其他/ ${item.otherPartName}`,\n          price: item.price,\n        });\n      }\n    })\n\n    if (onceData.data.length !== 0) {\n      feeDetails.push(onceData);\n    }\n\n    // 體驗\n\n    const experienceData = {\n      chargeType: 'cash',\n      chargeName: '體驗費用',\n      data: [],\n    }\n\n    coursePartOrderDetails.forEach(item => {\n      if (item.priceType === 'Experience') {\n        experienceData.data.push({\n          bodyPartName: bodyPartsOptions.find(itemA => itemA.id === item.bodyPartId).name,\n          price: item.price,\n        });\n      }\n    })\n\n    if (experienceData.data.length !== 0) {\n      feeDetails.push(experienceData);\n    }\n\n    // 押金\n\n    const depositData = {\n      chargeType: 'cash',\n      chargeName: '押金費用',\n      data: [],\n    }\n\n    coursePartOrderDetails.forEach(item => {\n      if (item.priceType === 'Deposit') {\n        depositData.data.push({\n          bodyPartName: bodyPartsOptions.find(itemA => itemA.id === item.bodyPartId).name,\n          price: item.price,\n        });\n      }\n    })\n\n    if (depositData.data.length !== 0) {\n      feeDetails.push(depositData);\n    }\n\n    // 雷射能量\n    laserRecord.value = [];\n\n    laserRecordRelativeData.forEach(item => {\n      let Refrigerant1;\n      let Refrigerant2;\n\n      item.laserRecordDetailData.forEach(item => {\n        if (item.laserEquipmentFeatureId === 'Refrigerant1') {\n          Refrigerant1 = item.value || null;\n        }\n\n        if (item.laserEquipmentFeatureId === 'Refrigerant2') {\n          Refrigerant2 = item.value || null;\n        }\n      })\n\n      laserRecord.value.push({\n        ...item,\n        Refrigerant1,\n        Refrigerant2\n      })\n    })\n    \n    historicalMedicalRecordData.value = {\n      voucherOrder,\n      subcourseData,\n      feeDetails,\n      careRecord, // 關心紀錄\n      ...medicalRecord,\n      notTreat: medicalRecord.notTreat,\n      repairCreamPrescribeMedicineRecords,\n      prescribeMedicineRecords,\n      customerDemandNames,\n      cancelled: doctorFreeRecord ? !doctorFreeRecord.cancelled : null,\n      reason: doctorFreeRecord ? doctorFreeRecord.reason : null,\n      anestheticUsageRecordData,\n      doctorDetailAnswerData,\n    }\n\n    // 控台確認\n    // consoleConfirmJudge.value = medicalRecord.consoleConfirmed;\n  }\n\n  /** 選擇病歷紀錄 */\n  function selectHistoricalMedicalRecord(index) {\n    historicalMedicalRecordOptionFocusNum.value = index;\n    const historicalMedicalRecord = historicalMedicalRecordOption.value[index];\n\n    getHistoricalMedicalRecordTagData(historicalMedicalRecord);\n  }\n\n  /** 分頁初始 */\n  function initPagination() {\n\n    maximumPages.value = historicalMedicalRecordOption.value.length / 10;\n\n    if (maximumPages.value <= 1) return null;\n\n    maximumPages.value = Math.ceil(maximumPages.value);\n\n    for(let i = 1; i <= maximumPages.value; i++) {\n      pagination.value.push(i);\n    }\n  }\n  \n  /** 前一頁 */\n  function previousPage() {\n    if (minimumRange.value === 1) return null;\n\n    minimumRange.value -= 3;\n    maximumRange.value -= 3;\n  } \n\n  /** 下一頁 */\n  function nextPage() {\n    let paginationNum = pagination.value.length / 3;\n    let maximumRangeNum = maximumRange.value / 3;\n\n    if (paginationNum <= maximumRangeNum) return null;\n    minimumRange.value += 3;\n    maximumRange.value += 3;\n  }\n\n  /** 前往最後一頁 */\n  function goLastPage() {\n    let paginationNum = pagination.value.length / 3;\n    minimumRange.value = Math.ceil(paginationNum) * 3 - 2;\n    maximumRange.value = Math.ceil(paginationNum) * 3;\n\n    paginationFocusNum.value = pagination.value.length;\n  }\n\n  // 聯絡紀錄\n  const contactRecordModelRef = ref(null);\n  let contactRecordModel;\n\n  onMounted(() => {\n    contactRecordModel = new Modal(contactRecordModelRef.value);\n  })\n\n  /** 開啟聯絡紀錄 */\n  function openContactRecordModel(item) {\n    getContactRecordByCustomer(item.customer.id);\n    contactRecordModel.show();\n  }\n\n  const contactRecordByCustomer = ref([]); // 聯絡紀錄\n\n  /** 取得客戶聯絡紀錄 */\n  async function getContactRecordByCustomer(customerId) {\n    const url = `/api/Customer/GetContactRecordByCustomer?customerId=${customerId}&limit=15`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET',\n    };\n\n    const response = await fetchApi(url, options);\n\n    contactRecordByCustomer.value = response.data;\n  }\n\n  // 關心內容\n\n  const editSign = ref(null);\n\n  const careSituation = ref([]);\n\n  /** 取得所有關心狀況 */\n  async function getCareSituation() {\n    const url = `/api/CareSituation/GetAll`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET',\n    };\n\n    const response = await fetchApi(url, options);\n\n    careSituation.value = response.data;\n  }\n\n  /** 取得關心後的反饋選項 (關心內容下面的選項)，自行過濾出該療程類型的選項(已排序) */\n  const careFeedback = ref([]);\n\n  async function getCareFeedbackAll() {\n    const url = `/api/CareFeedback/GetAll`;\n\n\n    const options = {\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\" : `Bearer ${getTokenFromCookie()}`\n      },\n      method: 'GET',\n    };\n\n    const response = await fetchApi(url, options);\n\n    careFeedback.value = response.data;\n  }\n\n  async function init() {\n    await getBeauticiansAAForCare();\n    await getAllDoctorData();\n\n    await getCourseTypeData();\n    // await getAllCourse();\n\n    await getCareSituation();\n    await getCareFeedbackAll();\n\n    // 關心資料初始\n    loggedInBeautician.value = JSON.parse(localStorage.getItem('employee'));\n\n    const judge = beauticiansAAForCareData.value.some(item => item.id === loggedInBeautician.value.employeeId);\n\n    if (judge) {\n      searchCareData.value.beauticianId = loggedInBeautician.value.employeeId;\n    } else {\n      searchCareData.value.beauticianId = beauticiansAAForCareData.value[0].id;\n    }\n\n    searchCareData.value.cared = false;\n    caredTextJudge.value = searchCareData.value.cared;\n\n    await careRecordSearchCareData();\n  }\n\n  // init();\n\n  onMounted(async() => {\n    await init();\n    if (careData.value.length !== 0) {\n      accordionToggle(0, accordion.value.toggleCustomerData);\n    }\n  })\n</script>\n\n<style lang=\"scss\" scoped>\n  .toggle-style {\n    overflow: hidden;\n    max-height: 0px;\n    transition: max-height 0.3s ease-out;\n  }\n\n  .toggle-icon-style {\n  transition: transform 0.3s ease-out;\n  transform: rotate(0deg);\n  }\n\n  .nickName-icon {\n    width: 22px;\n    height: 22px;\n    font-size: 12px; \n    font-weight: 700;\n  }\n\n  .text-mark {\n    color: #E06656;\n  }\n</style>\n","import script from \"./careRecordIndex.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./careRecordIndex.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./careRecordIndex.vue?vue&type=style&index=0&id=f0c56362&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\shang\\\\OneDrive\\\\桌面\\\\amis\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f0c56362\"]])\n\nexport default __exports__"],"names":["accordions","inject","accordionToggle","alertMessage","updateMessage","textConversionTool","convertTimeFormatDeleteSecond","deleteTTimeFormat","convertTimeFormatSlash","dateConversionWeek","fetchFunction","fetchApi","getTokenFromCookie","Employee","employeeState","getBeauticiansAAForCare","getAllDoctorData","getBeauticians","beauticiansAAForCareData","allDoctorData","beauticiansData","toRefs","courseType","courseTypeState","getCourseTypeData","courseTypeData","accordion","ref","toggleCustomerData","className","maxHeight","style","open","close","loggedInBeautician","searchCareData","beauticianId","operatorId","cared","startDate","endDate","customerName","customerCellPhone","customerBirthday","careData","caredTextJudge","async","careRecordSearchCareData","url","key","Object","keys","value","forEach","item","includes","console","log","options","headers","method","response","data","nextTick","length","disable","careDataLength","num","careRecordWithMedicalRecordInfo","resetCareRecordSearchCareData","judge","some","id","employeeId","customerCommunicationModalRef","customerCommunicationModal","customerCommunicationData","openCustomerCommunicationModal","getCustomerTraitAll","getCustomerById","customer","attention","habit","personality","trait","customerId","show","customerCommunicationConfirm","body","JSON","stringify","message","statusCode","hide","onMounted","Modal","customerTrait","editCareRecord","editSign","confirmUpdate","index","medicalRecordId","situation","careSituation","comment","careRecordComment","careFeedbackIdList","careRecordFeedbackIdList","careRecordId","push","updateCareRecordData","getCareRecordByMedicalRecord","t","t2","smsSampleModalRef","smsSampleModal","employeeSmsSample","getByEmployeeSmsSample","smsSampleCustomer","smsSampleCustomerId","openSmsSampleModal","smsRecordContent","smsSampleIndex","find","default","content","editSmsSampleId","beautician","nickname","editSmsSample","deleteSmsSampleModalRef","deleteSmsSampleModal","sendSmsRecord","saveAsExample","editCompleted","deleteSmsSample","openDeleteSmsSampleModal","deleteSmsSampleConfirm","cancelDeleteSmsSample","selectSmsSample","historicalMedicalRecordsRef","historicalMedicalRecordsRefModel","historicalMedicalRecordOption","historicalMedicalRecordOptionFocusNum","courseTypeSelected","courseTypeWindow","pagination","maximumPages","minimumRange","maximumRange","paginationFocusNum","laserRecord","getHistoricalMedicalRecordOption","courseTypeArr","paginationFocusPage","historicalMedicalRecordCustomerId","openHistoricalMedicalRecordsRefModal","itme","name","initPagination","selectHistoricalMedicalRecord","openCourseTypeWindow","document","removeEventListener","addEventListener","selectCourseType","idArr","map","historicalMedicalRecordTagData","historicalMedicalRecordTagIndex","selectHistoricalMedicalRecordTag","getHistoricalMedicalRecordData","getHistoricalMedicalRecordTagData","historicalMedicalRecord","appointmentDate","historicalMedicalRecordData","historicalMedicalRecordDataCollation","employeeStampData","getEmployeeStampData","medicalRecord","operator","voucherOrderDetails","subcourseData","anestheticOrderDetail","coursePartOrderDetails","bodyPartsOptions","careRecord","repairCreamPrescribeMedicineRecords","prescribeMedicineRecords","doctorFreeRecord","customerDemandNames","laserRecordRelativeData","anestheticUsageRecordData","doctorDetailAnswerData","voucherOrder","itemA","bodyPartName","itemB","bodyPartId","voucherId","feeDetails","anesthesiaSituation","chargeType","chargeName","price","onceData","priceType","otherPartName","experienceData","depositData","Refrigerant1","Refrigerant2","laserRecordDetailData","laserEquipmentFeatureId","notTreat","cancelled","reason","Math","ceil","i","previousPage","nextPage","paginationNum","maximumRangeNum","goLastPage","contactRecordModelRef","contactRecordModel","openContactRecordModel","getContactRecordByCustomer","contactRecordByCustomer","getCareSituation","careFeedback","getCareFeedbackAll","init","parse","localStorage","getItem","__exports__"],"sourceRoot":""}